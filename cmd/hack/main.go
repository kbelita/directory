/*
Hack to try to reissue certificates and correctly update alice and bob.
*/
package main

import (
	"bytes"
	"context"
	"crypto/x509"
	"encoding/base64"
	"encoding/pem"
	"errors"
	"fmt"
	"log"
	"time"

	"github.com/joho/godotenv"
	"github.com/trisacrypto/directory/pkg/gds/config"
	"github.com/trisacrypto/directory/pkg/gds/models/v1"
	"github.com/trisacrypto/directory/pkg/gds/secrets"
	"github.com/trisacrypto/directory/pkg/gds/store"
	pb "github.com/trisacrypto/trisa/pkg/trisa/gds/models/v1beta1"
	"github.com/trisacrypto/trisa/pkg/trust"
	"google.golang.org/protobuf/proto"
)

var (
	db   store.Store
	conf config.Config
)

func main() {
	// Load the dotenv file if it exists
	godotenv.Load()

	var err error
	// if err = makeIdentityCertificate("/Users/benjamin/Downloads/batch.zip", "supersecret"); err != nil {
	// 	log.Fatal(err)
	// }

	// Load the configuration from the environment
	if conf, err = config.New(); err != nil {
		log.Fatal(err)
	}
	conf.Database.ReindexOnBoot = false

	// Connect to the trtl server and create a store to access data directly like GDS
	if db, err = store.Open(conf.Database); err != nil {
		log.Fatal(err)
	}

	// JOB 1: update the Alice and Bob records if we're on the TestNet.
	// if err = updateRobotCerts(); err != nil {
	// 	log.Fatal(err)
	// }

	// JOB 2: reissue certificates for NMS
	// if err = reissueNMSCerts(); err != nil {
	// 	log.Fatal(err)
	// }

	// JOB 3: reissue certificates for Sygna
	// if err = reissueSygnaCerts(); err != nil {
	// 	log.Fatal(err)
	// }

	// JOB 4: delete old Hodlnaut record in favor of new records
	// if err = replaceHodlenaut(); err != nil {
	// 	log.Fatal(err)
	// }

	// JOB 5: update Hodlnaut records once again because le sigh.
	// if err = updateHodlnautP2(); err != nil {
	// 	log.Fatal(err)
	// }

	// Job 6: reissue trisa.rotational.io certificates
	if err = reissueRotational(); err != nil {
		log.Fatal(err)
	}
}

func makeIdentityCertificate(path, pkcs12password string) (err error) {
	var archive *trust.Serializer
	if archive, err = trust.NewSerializer(true, pkcs12password, trust.CompressionZIP); err != nil {
		return err
	}

	var provider *trust.Provider
	if provider, err = archive.ReadFile(path); err != nil {
		return err
	}

	var cert *x509.Certificate
	if cert, err = provider.GetLeafCertificate(); err != nil {
		return err
	}

	pub := &pb.Certificate{
		Version:            int64(cert.Version),
		SerialNumber:       cert.SerialNumber.Bytes(),
		Signature:          cert.Signature,
		SignatureAlgorithm: cert.SignatureAlgorithm.String(),
		PublicKeyAlgorithm: cert.PublicKeyAlgorithm.String(),
		Subject: &pb.Name{
			CommonName:         cert.Subject.CommonName,
			SerialNumber:       cert.Subject.SerialNumber,
			Organization:       cert.Subject.Organization,
			OrganizationalUnit: cert.Subject.OrganizationalUnit,
			StreetAddress:      cert.Subject.StreetAddress,
			Locality:           cert.Subject.Locality,
			Province:           cert.Subject.Province,
			PostalCode:         cert.Subject.PostalCode,
			Country:            cert.Subject.Country,
		},
		Issuer: &pb.Name{
			CommonName:         cert.Issuer.CommonName,
			SerialNumber:       cert.Issuer.SerialNumber,
			Organization:       cert.Issuer.Organization,
			OrganizationalUnit: cert.Issuer.OrganizationalUnit,
			StreetAddress:      cert.Issuer.StreetAddress,
			Locality:           cert.Issuer.Locality,
			Province:           cert.Issuer.Province,
			PostalCode:         cert.Issuer.PostalCode,
			Country:            cert.Issuer.Country,
		},
		NotBefore: cert.NotBefore.Format(time.RFC3339),
		NotAfter:  cert.NotAfter.Format(time.RFC3339),
		Revoked:   false,
	}

	// Write the public certificate into the directory service data store
	buf := bytes.NewBuffer(nil)
	if err = pem.Encode(buf, &pem.Block{Type: "CERTIFICATE", Bytes: cert.Raw}); err != nil {
		return fmt.Errorf("could not PEM encode certificate: %s", err)
	}
	pub.Data = buf.Bytes()

	// Write the entire provider chain into the directory service data store
	if archive, err = trust.NewSerializer(false, "", trust.CompressionGZIP); err != nil {
		return err
	}

	// Ensure only the public keys are written to the directory service
	if pub.Chain, err = archive.Compress(provider.Public()); err != nil {
		return err
	}

	// Now serialize and base64 encode the certificate
	var data []byte
	if data, err = proto.Marshal(pub); err != nil {
		return err
	}

	fmt.Println(base64.StdEncoding.EncodeToString(data))
	return nil
}

func updateRobotCerts() (err error) {
	names := map[string]string{
		"alice": "7a96ca2c-2818-4106-932e-1bcfd743b04c",
		"bob":   "9e069e01-8515-4d57-b9a5-e249f7ab4fca",
	}

	for name, vaspID := range names {
		// Lookup the VASP record
		var vasp *pb.VASP
		if vasp, err = db.RetrieveVASP(vaspID); err != nil {
			return fmt.Errorf("unable to retrieve %s record: %v", name, err)
		}

		// Unmarshal the identity certificate
		var data []byte
		if data, err = base64.StdEncoding.DecodeString(certs[name]); err != nil {
			return fmt.Errorf("could not deocde base64 for %s: %v", name, err)
		}

		vasp.IdentityCertificate = new(pb.Certificate)
		if err = proto.Unmarshal(data, vasp.IdentityCertificate); err != nil {
			return fmt.Errorf("could not unmarshal %s certificate: %v", name, err)
		}

		// Update the VASP status as verified/certificate issued
		if err = models.UpdateVerificationStatus(vasp, pb.VerificationState_VERIFIED, "manual certificate reissuance", "benjamin@rotational.io"); err != nil {
			return fmt.Errorf("could not update VASP verification status %s: %v", name, err)
		}
		if err = db.UpdateVASP(vasp); err != nil {
			return fmt.Errorf("could not update VASP %s: %v", name, err)
		}

		// Create certificate request for the issued certs
		if err = db.UpdateCertReq(certreqs[name]); err != nil {
			return fmt.Errorf("could not save certificate request for VASP %s: %v", name, err)
		}
	}
	return nil
}

var certs = map[string]string{
	"alice": "CAMSEGC53MBF1ZYImUrSF5/EpEQagAREgXemG6RJ3ubLvYAWNpGZIPCEvMaUseoboRQOcFkze0teJTyJsOgl0tbR5R3jerVSn1UfZzrVmj4A2rGSS/SJa/9x1/YzSO7J1utTXU+/lDUcWGWOZ3X/QOFomifWg3KfgDuB2j4dgALWtwdSidOTXrm8Sxsj0fJTGpiG6Usr8Hkft7FkFxa8hhG0GHbxPljW/GZ6u8lTtUCaSWmmM6rA3ixiI55wxxH4xC9EknM9PTzL1yTumx58Xf6ogCsMPPJHH5AcSuK3wTl0809Lx4pR0o8w0SX0E8t/pqm4/WyKxSnVCjn2v0q/ThM6lYlY0q2f5MwXtG3yGOzH2duBwjpQ3L8N5/n+Jf+GWoE7Rh/ClPKlEh/hHjtnwD/9CXykHMFMXLHQAaziE9n8UaYQ9X77vqnE/QYwjtMfK9OY+NV6lzhq6tGk9Ed2oqVdJQtGvZOO9QfGzQWKzNpfncbSXS+eLrjtzQB7VOhxJyfGajBRg93xjvd8ZDscS2I0SVriZ0UxGzpfJEEZmpYu6BdM0637gr+TBYPAPayFo4iDYXxfravpO6PTPZxQAwOtoouvw7R+p5/06jtzIqYVCu1vJAf3L2XIdIo1Kbdxjlqfv1fGGe9TlA1CCY0l/IsMVTKUElO9J5k/wDiACdNEIyXNclbccDhiWDIBESKSTAp7YRQxsiIKU0hBMzg0LVJTQSoDUlNBMkQKFWFwaS5hbGljZS52YXNwYm90Lm5ldBoPQ2lwaGVyVHJhY2UgSW5jMgpNZW5sbyBQYXJrOgpDYWxpZm9ybmlhSgJVUzpFChZDaXBoZXJUcmFjZSBJc3N1aW5nIENBGg9DaXBoZXJUcmFjZSBJbmMyCk1lbmxvIFBhcms6CkNhbGlmb3JuaWFKAlVTQhQyMDIyLTAyLTI4VDE3OjM5OjM4WkoUMjAyMy0wMy0yOFQxNzozOTozN1pawBMtLS0tLUJFR0lOIENFUlRJRklDQVRFLS0tLS0KTUlJSEJqQ0NCTzZnQXdJQkFnSVFZTG5jd0VYVmxnaVpTdElYbjhTa1JEQU5CZ2txaGtpRzl3MEJBUXdGQURCeQpNUXN3Q1FZRFZRUUdFd0pWVXpFVE1CRUdBMVVFQ0JNS1EyRnNhV1p2Y201cFlURVRNQkVHQTFVRUJ4TUtUV1Z1CmJHOGdVR0Z5YXpFWU1CWUdBMVVFQ2hNUFEybHdhR1Z5VkhKaFkyVWdTVzVqTVI4d0hRWURWUVFERXhaRGFYQm8KWlhKVWNtRmpaU0JKYzNOMWFXNW5JRU5CTUI0WERUSXlNREl5T0RFM016a3pPRm9YRFRJek1ETXlPREUzTXpregpOMW93Y1RFTE1Ba0dBMVVFQmhNQ1ZWTXhFekFSQmdOVkJBZ1RDa05oYkdsbWIzSnVhV0V4RXpBUkJnTlZCQWNUCkNrMWxibXh2SUZCaGNtc3hHREFXQmdOVkJBb1REME5wY0dobGNsUnlZV05sSUVsdVl6RWVNQndHQTFVRUF4TVYKWVhCcExtRnNhV05sTG5aaGMzQmliM1F1Ym1WME1JSUNJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBZzhBTUlJQwpDZ0tDQWdFQXhWZVpjdGJ5YzhWL3MwUW5MZXRpOEJ1ekJiMWR0cDhMTzVETHBzUHd6dHR5VWNIZWNpZ0NjNjNKCk9wR0VpSVh4dHI0T1BRN2Z5bHNkd3dTQ1ZDUEtRNVByZGJHYzlwQW1LTUk0Nm9TTjN2OWQ3dFRXSm5wMFladlcKUytadXJYNVRoL0RyakJGZ2ZTdnhkVVZrQTVpcjJtcStrUUt6bkQvTlFXbU9ETXhqdFh6MHFWaWQrQlk0S2c3awpEd2JHY0VUL3FoR0lJTFh1N2NGK0oya3FUenFEM2pnaEVkOGxOMllTdm5ySXdYbkNaRjJEZVRINDVBTmtLeHpTCmw3d0owY2lBU1pvZUZKUDRNdjNFdEJ5UHBKWnRuMlZlWlJETktGNzdaMTVMYkdTOFl3QUJMZUNyUzhIV1ZGVk0KMGFBUlNkWjRpYkJudWxockdUdkJTdmpVQWtmbXpsSmVKSitNQWxvQ0tRazFKVy8xTElReTNtczhHNlVXZWJqVQpZelBxT3RDdTN5TFJVeDNmQzM4ZzNvRnFibmlxdUYySVpQWThueGVBak1COS9iWGZWVlltWXpPSHhWQW0yMG5MCm9LR0ZrVkx0NWptYlNTb0xOMGtZNEtuN1Q5dFZ4TzMzcTlpaGtQTnl4SlIzeDBwQzFoT05LU1JUb2dXeEpsSXQKM01XYkUxZCtGMGlPd0NjMTk2ZlpOdG9seVlpTW1jK05Sd2lpdC8vc0Q4R3dabkU5UzRpQzcwTTc3bTdzNGE1cQpjN2tKNHlIdnJSb3p2SEhSQnFqdEdMbXArQ0dNVW9CUVk2SVJhMUxMeVRWbjA5SmVMdGoxejlhNDFyNVoyeHppCmJKcHZiQnN2Vzh3Q2U2cHpVb2JOd2RBbjhBaEt1NTAzV1laSjNqRWVOUW8rVWJ3Q01lOENBd0VBQWFPQ0FaY3cKZ2dHVE1COEdBMVVkSXdRWU1CYUFGRnU3aU03WkdEbkxpMnVDOFFCdldtUW00LzEyTUE0R0ExVWREd0VCL3dRRQpBd0lGNERBTUJnTlZIUk1CQWY4RUFqQUFNQ0FHQTFVZEpRRUIvd1FXTUJRR0NDc0dBUVVGQndNQ0JnZ3JCZ0VGCkJRY0RBVEJWQmdOVkhSOEVUakJNTUVxZ1NLQkdoa1JvZEhSd09pOHZZMmx3YUdWeWRISmhZMlV1WTNKc0xtbHYKZEM1elpXTjBhV2R2TG1OdmJTOURhWEJvWlhKVWNtRmpaVWx1ZEdWeWJXVmthV0YwWlVOQkxtTnliRENCbHdZSQpLd1lCQlFVSEFRRUVnWW93Z1ljd1VBWUlLd1lCQlFVSE1BS0dSR2gwZEhBNkx5OWphWEJvWlhKMGNtRmpaUzVqCmNuUXVhVzkwTG5ObFkzUnBaMjh1WTI5dEwwTnBjR2hsY2xSeVlXTmxTVzUwWlhKdFpXUnBZWFJsUTBFdVkzSjAKTURNR0NDc0dBUVVGQnpBQmhpZG9kSFJ3T2k4dlkybHdhR1Z5ZEhKaFkyVXViMk56Y0M1cGIzUXVjMlZqZEdsbgpieTVqYjIwd0lBWURWUjBSQkJrd0Y0SVZZWEJwTG1Gc2FXTmxMblpoYzNCaWIzUXVibVYwTUIwR0ExVWREZ1FXCkJCUnovb2s3TW5yM25Pbzh6N0xhTmtEWlc5L2pzekFOQmdrcWhraUc5dzBCQVF3RkFBT0NBZ0VBUklGM3BodWsKU2Q3bXk3MkFGamFSbVNEd2hMekdsTEhxRzZFVURuQlpNM3RMWGlVOGliRG9KZExXMGVVZDQzcTFVcDlWSDJjNgoxWm8rQU5xeGtrdjBpV3YvY2RmMk0wanV5ZGJyVTExUHY1UTFIRmhsam1kMS8wRGhhSm9uMW9OeW40QTdnZG8rCkhZQUMxcmNIVW9uVGsxNjV2RXNiSTlIeVV4cVlodWxMSy9CNUg3ZXhaQmNXdklZUnRCaDI4VDVZMXZ4bWVydkoKVTdWQW1rbHBwak9xd040c1lpT2VjTWNSK01RdlJKSnpQVDA4eTljazdwc2VmRjMrcUlBckREenlSeCtRSEVyaQp0OEU1ZFBOUFM4ZUtVZEtQTU5FbDlCUExmNmFwdVAxc2lzVXAxUW81OXI5S3YwNFRPcFdKV05LdG4rVE1GN1J0CjhoanN4OW5iZ2NJNlVOeS9EZWY1L2lYL2hscUJPMFlmd3BUeXBSSWY0UjQ3WjhBLy9RbDhwQnpCVEZ5eDBBR3MKNGhQWi9GR21FUFYrKzc2cHhQMEdNSTdUSHl2VG1QalZlcGM0YXVyUnBQUkhkcUtsWFNVTFJyMlRqdlVIeHMwRgppc3phWDUzRzBsMHZuaTY0N2MwQWUxVG9jU2NueG1vd1VZUGQ4WTczZkdRN0hFdGlORWxhNG1kRk1SczZYeVJCCkdacVdMdWdYVE5PdCs0Sy9rd1dEd0Qyc2hhT0lnMkY4WDYycjZUdWowejJjVUFNRHJhS0xyOE8wZnFlZjlPbzcKY3lLbUZRcnRieVFIOXk5bHlIU0tOU20zY1k1YW43OVh4aG52VTVRTlFnbU5KZnlMREZVeWxCSlR2U2VaUDhBNApnQW5UUkNNbHpYSlczSEE0WWxneUFSRWlra3dLZTJFVU1iST0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQpizyIfiwgAAAAAAAD/zJjH8utKkt73eArtGQrCm8UsCt4T3u3gCA8QIPzTK/7n3L59e6ZnRlJHKMRllkl+hagvf5X/8+fHCpJi/g9OcDxFVDjgCb+ikKEoMttyHPsiK3AoLKgUO9bH/BCioK+axF2VaKTdzuGByVbdXHeNxBwwC+xDBDx7QYb9PTg75gPbloRDDfxb8AxWkADiCxxraDYqftMw2fOB+MTe38fY09C8MNigTKIrXxKv9BZig41/L6wNy0b7I5WCK5DVOkb9yg2J1nDoQ/6djBfOhE8jdoKSSPXzQWwTl1VzzETSkBgVwWQNFo94T7kMXrlevIAZd3e/xOkndhu88WcMMpHpyD1BN0D3+6/VBhcExincwGErM2BB5XGdWWdSP2SYuqWh8Jex3IO4Dumz4dwVka3z4XtKPAh/D04eD5ufXKr7vHeuODR7Rei3+BZKgz1+JQOnEUBxxH704eegzF4fkzrH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",
	"bob":   "CAMSEB5ZHHcuDf+zq9ac0Vm+ujgagARv1TdUlFIF26KaLYi8LNLe8Z2MDe6EBiK1URXDyShqwV3QIBGibBdg6+kP/OMC1AxebnqXMQWwAnHoKgwJ1vXt58Ak4d3EWcHrYlK3KsGKQ+catN2WuWataXwzZoJKBlD8KwST3FFvY+0mgCEg2FK2fkX1xDe4yJrG3UEQVA+EHcfJrFWwujuR+WlT1uXedcpOhv23nHTlobxwr+y4yiJBlefXfROZQ7FA7iBpHuaDKmZAXv2vHnGF0Pk9L8dLfSOB34kMd2MJEp6I5M0oHBr0EL1LOZ6hP2HwPdvXsxwcFi/6VIMXyz9aJ1P25mKLNRX41ebA89YAc83v/V7ubbPbdlXkj4OZRudmtpA0dK9VzErdX6H6N02c/1m9Xl3Rcr4y1PdWKL2NxbK1K8MtkILRasHHYQVvcr+Bj+lrNvydOBeeVkjK025vAnGz2308rZ9ICtdEmNmqFBMYyYmO+GsYdq4x1Ak8nKybqVbS7NZsQAq+f0g5thSI1vRSI3nopGX9wmlLO9taybZGK6CxID57KB+mJZYCFkkN6gok614cUzEW2/ISycqk+YCJXry/4eqpq+bIHX8O7Bpk93WDcmvhZbJYtpjJoHHXbWS4AqsQnyE6yMcRMO0s1OuDyZpySLyJ3oW5cAVT0oDcQfwHSpdZElzoJHjS7dZXujdIN6h1QSIKU0hBMzg0LVJTQSoDUlNBMkIKE2FwaS5ib2IudmFzcGJvdC5uZXQaD0NpcGhlclRyYWNlIEluYzIKTWVubG8gUGFyazoKQ2FsaWZvcm5pYUoCVVM6RQoWQ2lwaGVyVHJhY2UgSXNzdWluZyBDQRoPQ2lwaGVyVHJhY2UgSW5jMgpNZW5sbyBQYXJrOgpDYWxpZm9ybmlhSgJVU0IUMjAyMi0wMi0yOFQxNzo1MzozNVpKFDIwMjMtMDMtMjhUMTc6NTM6MzRaWrwTLS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUhBakNDQk9xZ0F3SUJBZ0lRSGxrY2R5NE4vN09yMXB6UldiNjZPREFOQmdrcWhraUc5dzBCQVF3RkFEQnkKTVFzd0NRWURWUVFHRXdKVlV6RVRNQkVHQTFVRUNCTUtRMkZzYVdadmNtNXBZVEVUTUJFR0ExVUVCeE1LVFdWdQpiRzhnVUdGeWF6RVlNQllHQTFVRUNoTVBRMmx3YUdWeVZISmhZMlVnU1c1ak1SOHdIUVlEVlFRREV4WkRhWEJvClpYSlVjbUZqWlNCSmMzTjFhVzVuSUVOQk1CNFhEVEl5TURJeU9ERTNOVE16TlZvWERUSXpNRE15T0RFM05UTXoKTkZvd2J6RUxNQWtHQTFVRUJoTUNWVk14RXpBUkJnTlZCQWdUQ2tOaGJHbG1iM0p1YVdFeEV6QVJCZ05WQkFjVApDazFsYm14dklGQmhjbXN4R0RBV0JnTlZCQW9URDBOcGNHaGxjbFJ5WVdObElFbHVZekVjTUJvR0ExVUVBeE1UCllYQnBMbUp2WWk1MllYTndZbTkwTG01bGREQ0NBaUl3RFFZSktvWklodmNOQVFFQkJRQURnZ0lQQURDQ0Fnb0MKZ2dJQkFOeHBqVGRoMisweXlMakRFYUxlRUZEYXJaUmg0TExPNThNbHFseFBVTCtwcTdrano1QVpSelRjb1NlZgpxQ0V1aHpDWi9UdlZOcUV3ZWt1Tk45T01jc3NmSk5lYW1jN3RYSGltbFptWUVwRVZ3eW10NjREQ2orUFlIWDFMCmRyRldEZ09Kc1BGMDI4ZFFuVWljMXFWVy9DOWNLSnBSa25lZGNJbUZZanJDNWNnQkZZZnQvRnZ2bVVGL3Q0cEcKTWJHYWoyZklKWUVYdGt6b1p2dElvNjg0Qzd5L2t2NzJVdmpiU3RpcUZzVkIvaUhrSVd6ZzJwdTJiQ1VFR0RaagpoNTV6aDhITXloMEwzeEZ2RGxuUXl1eWdMYUlNRU1EVHlhTksrRlpZVHBNcWNXVjdVR0o1ZGFiZ2NiLzIvRUhPClZoKzJ2dkNpc2QzcTV5YmlyQzZlUVJ5UXFFYnFkNzd3NHRaRFVyOThvUytEemdHZ2VVdWY3OVpJZ1dYOXg1S0UKRkFaOWpsdzRtRnVPQVE5dTYzMU5iT0llYVFZT3RLZ05RNGg1OVhHQzBjRHFxWFc1NlFkeFAweVFDb3hNODYwawplVjVNNkdoV3E2QUJudVdJN1dieVBTaHhvaWhyUzd1cHVtZE11RHBTRHQwYWxsR0ZmbTFLeXNZUkZiL1N6NXFCCjRYMkUrSk54T0daUUxsT2FpQm1icXdPeE9wY2lndEVjVlc1QkVSVDJ6aVMrdGttUEVqRjFxeHMySFVCa3lHL04KYWhvNjBFZVFzYWgvZWNlVzJuMVllWlFPYlNpcWU2dkd0TXJPeFY3ZmNGc24vckoxdVBzSlpnL0l4aWxOSm5jbQpnUWk1S29IK080NVJYUU5jM0lUejdDVmdmd0VyaE1kUW9PZy91RmJ0dytkaHlIZlhBZ01CQUFHamdnR1ZNSUlCCmtUQWZCZ05WSFNNRUdEQVdnQlJidTRqTzJSZzV5NHRyZ3ZFQWIxcGtKdVA5ZGpBT0JnTlZIUThCQWY4RUJBTUMKQmVBd0RBWURWUjBUQVFIL0JBSXdBREFnQmdOVkhTVUJBZjhFRmpBVUJnZ3JCZ0VGQlFjREFnWUlLd1lCQlFVSApBd0V3VlFZRFZSMGZCRTR3VERCS29FaWdSb1pFYUhSMGNEb3ZMMk5wY0dobGNuUnlZV05sTG1OeWJDNXBiM1F1CmMyVmpkR2xuYnk1amIyMHZRMmx3YUdWeVZISmhZMlZKYm5SbGNtMWxaR2xoZEdWRFFTNWpjbXd3Z1pjR0NDc0cKQVFVRkJ3RUJCSUdLTUlHSE1GQUdDQ3NHQVFVRkJ6QUNoa1JvZEhSd09pOHZZMmx3YUdWeWRISmhZMlV1WTNKMApMbWx2ZEM1elpXTjBhV2R2TG1OdmJTOURhWEJvWlhKVWNtRmpaVWx1ZEdWeWJXVmthV0YwWlVOQkxtTnlkREF6CkJnZ3JCZ0VGQlFjd0FZWW5hSFIwY0RvdkwyTnBjR2hsY25SeVlXTmxMbTlqYzNBdWFXOTBMbk5sWTNScFoyOHUKWTI5dE1CNEdBMVVkRVFRWE1CV0NFMkZ3YVM1aWIySXVkbUZ6Y0dKdmRDNXVaWFF3SFFZRFZSME9CQllFRk83ZQo3UExTZUdPUXI2aVhvN3RWN2xJTFR3YUxNQTBHQ1NxR1NJYjNEUUVCREFVQUE0SUNBUUJ2MVRkVWxGSUYyNkthCkxZaThMTkxlOFoyTURlNkVCaUsxVVJYRHlTaHF3VjNRSUJHaWJCZGc2K2tQL09NQzFBeGVibnFYTVFXd0FuSG8KS2d3SjF2WHQ1OEFrNGQzRVdjSHJZbEszS3NHS1ErY2F0TjJXdVdhdGFYd3pab0pLQmxEOEt3U1QzRkZ2WSswbQpnQ0VnMkZLMmZrWDF4RGU0eUpyRzNVRVFWQStFSGNmSnJGV3d1anVSK1dsVDF1WGVkY3BPaHYyM25IVGxvYnh3CnIreTR5aUpCbGVmWGZST1pRN0ZBN2lCcEh1YURLbVpBWHYydkhuR0YwUGs5TDhkTGZTT0IzNGtNZDJNSkVwNkkKNU0wb0hCcjBFTDFMT1o2aFAySHdQZHZYc3h3Y0ZpLzZWSU1YeXo5YUoxUDI1bUtMTlJYNDFlYkE4OVlBYzgzdgovVjd1YmJQYmRsWGtqNE9aUnVkbXRwQTBkSzlWekVyZFg2SDZOMDJjLzFtOVhsM1JjcjR5MVBkV0tMMk54YksxCks4TXRrSUxSYXNISFlRVnZjcitCaitsck52eWRPQmVlVmtqSzAyNXZBbkd6MjMwOHJaOUlDdGRFbU5tcUZCTVkKeVltTytHc1lkcTR4MUFrOG5LeWJxVmJTN05ac1FBcStmMGc1dGhTSTF2UlNJM25vcEdYOXdtbExPOXRheWJaRwpLNkN4SUQ1N0tCK21KWllDRmtrTjZnb2s2MTRjVXpFVzIvSVN5Y3FrK1lDSlhyeS80ZXFwcStiSUhYOE83QnBrCjkzV0RjbXZoWmJKWXRwakpvSEhYYldTNEFxc1FueUU2eU1jUk1PMHMxT3VEeVpweVNMeUozb1c1Y0FWVDBvRGMKUWZ3SFNwZFpFbHpvSkhqUzdkWlh1amRJTjZoMVFRPT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQpisyIfiwgAAAAAAAD/1NjHzqxasiDgOU/R81Qr8WZwB3jvPTO8TxJvnr71733r1Dl1napLaqlzuAJWEEgR60v+98+P4UXZ+F8s73iyILO0x/9aBXRZluiOZRlzrulTZuhatqWhz4sbNd6EuUDfxwkzHDc52mDqfm76VqROkKHtU6A55gZ0ez1ZO+YC2xb5Uwn8h/d0hhdpyOdZRldtWFjTMDnyEfvG3t9jzKWrXhjsQCaStS8Kd/rwsc7Ev29sdMuGhzMVgzuQlCaG/doNsU53yFP6nYzjr4RLI2YCkkjx81HoEpdRcsSA0hD7yLzB6AwacZ5865x8mxyPGJ7+GMH0s/bonP7HGmAI05k9vKbT/e9Ha3Q2CPSLf2iHqY2AoWuP7Y0mE4cxQ5Q9Dfk/xXIPYHtoyMbrkAWmycf1Ejk6/B2cPA40vrnYDPng3HFoDDI/7PHD5zoz/UpGX7oHxBHz1UbliFsMjiPjjEcK1EZsKDiW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",
}

var certreqs = map[string]*models.CertificateRequest{
	"alice": {
		Id:           "e2d7ef62-28e2-4fb9-9fd6-4fb107d942a6",
		Vasp:         "7a96ca2c-2818-4106-932e-1bcfd743b04c",
		CommonName:   "api.alice.vaspbot.net",
		Status:       models.CertificateRequestState_COMPLETED,
		AuthorityId:  23,
		BatchId:      309867,
		BatchName:    "trisatest.net-certreq-e2d7ef62-28e2-4fb9-9fd6-4fb107d942a6",
		BatchStatus:  "READY_FOR_DOWNLOAD",
		OrderNumber:  309867,
		CreationDate: "2022-02-28T11:39:38.000+0000",
		Profile:      "CipherTrace EE",
		RejectReason: "",
		Params:       map[string]string{},
		Created:      time.Now().Format(time.RFC3339Nano),
	},
	"bob": {
		Id:           "1177a95b-7e24-411a-a0a8-3210e4b93b2b",
		Vasp:         "9e069e01-8515-4d57-b9a5-e249f7ab4fca",
		CommonName:   "api.bob.vaspbot.net",
		Status:       models.CertificateRequestState_COMPLETED,
		AuthorityId:  23,
		BatchId:      309870,
		BatchName:    "trisatest.net-certreq-1177a95b-7e24-411a-a0a8-3210e4b93b2b",
		BatchStatus:  "READY_FOR_DOWNLOAD",
		OrderNumber:  309870,
		CreationDate: "2022-02-28T11:53:42.000+0000",
		Profile:      "CipherTrace EE",
		RejectReason: "",
		Params:       map[string]string{},
		Created:      time.Now().Format(time.RFC3339Nano),
	},
}

func reissueNMSCerts() (err error) {
	var vasp *pb.VASP
	vaspID := "00634f29-e22e-48f5-be2a-74feeee33464"
	commonName := "eczesgsg.trisa.test-travelrule.sygna.io"
	endpoint := "eczesgsg.trisa.test-travelrule.sygna.io:443"

	if vasp, err = db.RetrieveVASP(vaspID); err != nil {
		return fmt.Errorf("could not retrieve vasp record: %v", err)
	}

	// Reset the Travel Rule information
	vasp.CommonName = commonName
	vasp.TrisaEndpoint = endpoint
	vasp.IdentityCertificate = nil

	// Cannot validate
	// if err = vasp.Validate(false); err != nil {
	// 	return fmt.Errorf("vasp is not valid: %v", err)
	// }

	if err = models.UpdateVerificationStatus(vasp, pb.VerificationState_REVIEWED, "manually reissuing testnet certificates", "benjamin@rotational.io"); err != nil {
		return fmt.Errorf("could not update VASP record: %v", err)
	}

	// Create a new certificate request for the reissuance
	password := secrets.CreateToken(16)
	fmt.Printf("password is %q\n", password)

	var certreq *models.CertificateRequest
	if certreq, err = models.NewCertificateRequest(vasp); err != nil {
		return err
	}

	if err = models.UpdateCertificateRequestStatus(certreq, models.CertificateRequestState_READY_TO_SUBMIT, "reissue certificates", "benjamin@rotational.io"); err != nil {
		return fmt.Errorf("could not update certreq: %v", err)
	}

	// Connect to secret manager
	var sm *secrets.SecretManager
	if sm, err = secrets.New(conf.Secrets); err != nil {
		return err
	}

	// Make a new secret of type password
	secretType := "password"
	if err = sm.With(certreq.Id).CreateSecret(context.TODO(), secretType); err != nil {
		return err
	}
	if err = sm.With(certreq.Id).AddSecretVersion(context.TODO(), secretType, []byte(password)); err != nil {
		return err
	}

	// Update the certreq
	if err = db.UpdateCertReq(certreq); err != nil {
		return err
	}

	// Append the certificate request to the VASP
	if err = models.AppendCertReqID(vasp, certreq.Id); err != nil {
		return err
	}

	// Update the vasp
	if err = db.UpdateVASP(vasp); err != nil {
		return err
	}

	return nil
}

var vasptest1cert = "CAMSEHyhWDZSfNUfjnjx5FNXteUagAQLcta5zdtY87BsEPwVcyGgUSCGpXio2J17RmDCBQYiXhNnzYVnRzzp/CUUip463dguDy/Z+pv6F+cqoPLUez7sKKHxvtnv7QkFGFdWtNwUDZqhWKdZSXrpocIo03fmLHJYRjXs2kGr21eK2bwxPWpSikv1+3iu+VyMlv/ytIgIcz+hmEYWbeRLrSFmaNUP0VYfIRMipGY/0lIuyY8WNoNCKvEVudRQr5EHuc0ymoUl13tZP1S4uCuLo/+flpndTyI4z9dH3PK763TDHXW9HtsWCjeyHrE+96b8AqGYON1mnJoWbZgUcP4MeK2RmpC8MfNq5NuQa5UY6hZ4MD9ZAEEjNgFYWdW7gvWf5+E5KWmw+KRu3JEAH47VPTH05N+Hizf7+KxFSnbMby4ndoNoXc7tv+MLN0CnVFa3JOlkTpeFvofhyGbNV7Cs85Z3Yy09/Hkd+v54XOxxmVsrMfRu6K0JDHNULtFqQG8NI3Dg2Hd0nhfNRd0yhX1lTBNxTs/2tEpl+oh83ts88z0kzJmqtWAeY8zPdaxZPEpI8fewEZrapUY/79gqNS/2IqSAB9Ssll+nMjAMctm7k4GJEtXOZBEFf+7CckRj/+ugVWaZUkPMn1DWCZmCtGJiz4u2ietH5P7eoOLTKM0Omwl5jkSeEiPXhKF7FQ4NVgDvBY5keeVxtiIKU0hBMzg0LVJTQSoDUlNBMlAKIWdhdGV0dzA1LnRlc3QtdHJhdmVscnVsZS5zeWduYS5pbxoPQ2lwaGVyVHJhY2UgSW5jMgpNZW5sbyBQYXJrOgpDYWxpZm9ybmlhSgJVUzpFChZDaXBoZXJUcmFjZSBJc3N1aW5nIENBGg9DaXBoZXJUcmFjZSBJbmMyCk1lbmxvIFBhcms6CkNhbGlmb3JuaWFKAlVTQhQyMDIyLTAzLTMwVDAyOjQ3OjAwWkoUMjAyMy0wNC0zMFQwMjo0Njo1OVpa7xotLS0tLUJFR0lOIENFUlRJRklDQVRFLS0tLS0KTUlJSnZUQ0NCNldnQXdJQkFnSVFmS0ZZTmxKODFSK09lUEhrVTFlMTVUQU5CZ2txaGtpRzl3MEJBUXdGQURCeQpNUXN3Q1FZRFZRUUdFd0pWVXpFVE1CRUdBMVVFQ0JNS1EyRnNhV1p2Y201cFlURVRNQkVHQTFVRUJ4TUtUV1Z1CmJHOGdVR0Z5YXpFWU1CWUdBMVVFQ2hNUFEybHdhR1Z5VkhKaFkyVWdTVzVqTVI4d0hRWURWUVFERXhaRGFYQm8KWlhKVWNtRmpaU0JKYzNOMWFXNW5JRU5CTUI0WERUSXlNRE16TURBeU5EY3dNRm9YRFRJek1EUXpNREF5TkRZMQpPVm93ZlRFTE1Ba0dBMVVFQmhNQ1ZWTXhFekFSQmdOVkJBZ1RDa05oYkdsbWIzSnVhV0V4RXpBUkJnTlZCQWNUCkNrMWxibXh2SUZCaGNtc3hHREFXQmdOVkJBb1REME5wY0dobGNsUnlZV05sSUVsdVl6RXFNQ2dHQTFVRUF4TWgKWjJGMFpYUjNNRFV1ZEdWemRDMTBjbUYyWld4eWRXeGxMbk41WjI1aExtbHZNSUlDSWpBTkJna3Foa2lHOXcwQgpBUUVGQUFPQ0FnOEFNSUlDQ2dLQ0FnRUF3M0RmSTh2ekxscE82bWZqVDd2SU1zc1ZqVUNxU0pVS1VLdXFBWHJsCmFOdnNtdExZVmJoTzJrT01ML09rU080TEV4dDhmMzlTUEdtVXVzUmdVMVJWbHlOcExDSXdCb0tpd1drb3JuOHgKQ1VXb0w3QytGdmtRNnFYbHdYM1NON3NmVVRuY1ZhODBrR2EreTdLQk9KZm1KV29VcDV0N1VQell3TkUvNFEvMgpYekFOZEpiSlRMb3NidGd2bk5sZURQa3NRMkRlNzhzVkdxZHdmRjYxSzFNcllPL1ZlTVBBNzRJcHhNMWNUbDRkCkdxVkpvSkVJdGlHbXZHMG5iUC9vZ29PcnF1VjIrbWZ0blhrRE1tdzhmVGIxdFB4YWJrWkZ0VW9ndkxnQ0NGVzAKUVJOUWRDNXBoSFV4dnU4NXlRQVQxYWQzSWFXNDNqM2xyZDlTU0o3d25KeFpoOTlVbHFaUk12WHlNcWdyUEN5OApEOVlmdms3TkNna3lXTW9ZNjkxbUliUTIrSXA2SXZpcXo4L3J2eWV2MmE3SmtLeG5VdzFBTFFIYVlZTHl1bGlqCjlmdnY5UmwyWjdoNzJkdzhFR05RRnJTNldiajd4aEJtaS9IVHZZSzJOOFhqOGREWnJHWjBIQTBkOXkramUzS3kKWkVnYWVsMnJNT1drRElMU0J4RWYydmkzc1A3S2JENEFGNkxiWnIwanVXK0RFeHBTdWNCTUFZSVR1cUxaUjB2MwpnR0JSVS9SY250SHdJMmhNZXAzbVlyVVZoMzhVL0I2MFp2RUxCdk9xdWNXbDBpa29uV3R3NEl1L3lmclJCY1ZLCmVhb2NtVnVzVktiOHlQRE80TWRGQ2xzU1I0SzVYemFINitLUGRDS2YyNjdxSTBId3VGZFFJUzE2ZVMrRE9OSy8KOXprQ0F3RUFBYU9DQkVJd2dnUStNQjhHQTFVZEl3UVlNQmFBRkZ1N2lNN1pHRG5MaTJ1QzhRQnZXbVFtNC8xMgpNQTRHQTFVZER3RUIvd1FFQXdJRjREQU1CZ05WSFJNQkFmOEVBakFBTUNBR0ExVWRKUUVCL3dRV01CUUdDQ3NHCkFRVUZCd01DQmdnckJnRUZCUWNEQVRCVkJnTlZIUjhFVGpCTU1FcWdTS0JHaGtSb2RIUndPaTh2WTJsd2FHVnkKZEhKaFkyVXVZM0pzTG1sdmRDNXpaV04wYVdkdkxtTnZiUzlEYVhCb1pYSlVjbUZqWlVsdWRHVnliV1ZrYVdGMApaVU5CTG1OeWJEQ0Jsd1lJS3dZQkJRVUhBUUVFZ1lvd2dZY3dVQVlJS3dZQkJRVUhNQUtHUkdoMGRIQTZMeTlqCmFYQm9aWEowY21GalpTNWpjblF1YVc5MExuTmxZM1JwWjI4dVkyOXRMME5wY0dobGNsUnlZV05sU1c1MFpYSnQKWldScFlYUmxRMEV1WTNKME1ETUdDQ3NHQVFVRkJ6QUJoaWRvZEhSd09pOHZZMmx3YUdWeWRISmhZMlV1YjJOegpjQzVwYjNRdWMyVmpkR2xuYnk1amIyMHdnZ0xKQmdOVkhSRUVnZ0xBTUlJQ3ZJSWhaMkYwWlhSM01EVXVkR1Z6CmRDMTBjbUYyWld4eWRXeGxMbk41WjI1aExtbHZnaUZuWVdKdmFuQjBlUzUwWlhOMExYUnlZWFpsYkhKMWJHVXUKYzNsbmJtRXVhVytDSVhSbGMzUjBkM1JsTG5SbGMzUXRkSEpoZG1Wc2NuVnNaUzV6ZVdkdVlTNXBiNEloWW1sMApZbXR5YzJVdWRHVnpkQzEwY21GMlpXeHlkV3hsTG5ONVoyNWhMbWx2Z2lGa2IzSmhkSGQwY0M1MFpYTjBMWFJ5CllYWmxiSEoxYkdVdWMzbG5ibUV1YVcrQ0lXcHRZMmgwZHpBeUxuUmxjM1F0ZEhKaGRtVnNjblZzWlM1emVXZHUKWVM1cGI0SWhaMkZpYjNSM2RIQXVkR1Z6ZEMxMGNtRjJaV3h5ZFd4bExuTjVaMjVoTG1sdmdpRm5ZV0p2WVhWdApkUzUwWlhOMExYUnlZWFpsYkhKMWJHVXVjM2xuYm1FdWFXK0NJWFpoYzNCMGR6azVMblJsYzNRdGRISmhkbVZzCmNuVnNaUzV6ZVdkdVlTNXBiNEloWjJGMFpYUjNNRFl1ZEdWemRDMTBjbUYyWld4eWRXeGxMbk41WjI1aExtbHYKZ2lGemVXZHVZV1p4Ymk1MFpYTjBMWFJ5WVhabGJISjFiR1V1YzNsbmJtRXVhVytDSVhSbGMzUjBkSFIwTG5SbApjM1F0ZEhKaGRtVnNjblZzWlM1emVXZHVZUzVwYjRJaGMzbG5iblIzT0RFdWRHVnpkQzEwY21GMlpXeHlkV3hsCkxuTjVaMjVoTG1sdmdpRm5ZV0p2WTJGMGJ5NTBaWE4wTFhSeVlYWmxiSEoxYkdVdWMzbG5ibUV1YVcrQ0lYTjUKWjI1aFpuaHRMblJsYzNRdGRISmhkbVZzY25Wc1pTNXplV2R1WVM1cGI0SWhjM2xuYm1GbU4zTXVkR1Z6ZEMxMApjbUYyWld4eWRXeGxMbk41WjI1aExtbHZnaUZ6ZVdkdVoySnNiaTUwWlhOMExYUnlZWFpsYkhKMWJHVXVjM2xuCmJtRXVhVytDSVhONVoyNWhabTlzTG5SbGMzUXRkSEpoZG1Wc2NuVnNaUzV6ZVdkdVlTNXBiNEloWjJGMFpYUjMKTVRFdWRHVnpkQzEwY21GMlpXeHlkV3hsTG5ONVoyNWhMbWx2Z2lGemVXZHVZV1p1T0M1MFpYTjBMWFJ5WVhabApiSEoxYkdVdWMzbG5ibUV1YVc4d0hRWURWUjBPQkJZRUZERDdWd2U5a1RITjVmTWVWVmRURk5lSzk0UzdNQTBHCkNTcUdTSWIzRFFFQkRBVUFBNElDQVFBTGN0YTV6ZHRZODdCc0VQd1ZjeUdnVVNDR3BYaW8ySjE3Um1EQ0JRWWkKWGhObnpZVm5SenpwL0NVVWlwNDYzZGd1RHkvWitwdjZGK2Nxb1BMVWV6N3NLS0h4dnRudjdRa0ZHRmRXdE53VQpEWnFoV0tkWlNYcnBvY0lvMDNmbUxISllSalhzMmtHcjIxZUsyYnd4UFdwU2lrdjErM2l1K1Z5TWx2L3l0SWdJCmN6K2htRVlXYmVSTHJTRm1hTlVQMFZZZklSTWlwR1kvMGxJdXlZOFdOb05DS3ZFVnVkUlFyNUVIdWMweW1vVWwKMTN0WlAxUzR1Q3VMby8rZmxwbmRUeUk0ejlkSDNQSzc2M1RESFhXOUh0c1dDamV5SHJFKzk2YjhBcUdZT04xbQpuSm9XYlpnVWNQNE1lSzJSbXBDOE1mTnE1TnVRYTVVWTZoWjRNRDlaQUVFak5nRllXZFc3Z3ZXZjUrRTVLV213CitLUnUzSkVBSDQ3VlBUSDA1TitIaXpmNytLeEZTbmJNYnk0bmRvTm9YYzd0ditNTE4wQ25WRmEzSk9sa1RwZUYKdm9maHlHYk5WN0NzODVaM1l5MDkvSGtkK3Y1NFhPeHhtVnNyTWZSdTZLMEpESE5VTHRGcVFHOE5JM0RnMkhkMApuaGZOUmQweWhYMWxUQk54VHMvMnRFcGwrb2g4M3RzODh6MGt6Sm1xdFdBZVk4elBkYXhaUEVwSThmZXdFWnJhCnBVWS83OWdxTlMvMklxU0FCOVNzbGwrbk1qQU1jdG03azRHSkV0WE9aQkVGZis3Q2NrUmovK3VnVldhWlVrUE0KbjFEV0NabUN0R0ppejR1MmlldEg1UDdlb09MVEtNME9td2w1amtTZUVpUFhoS0Y3RlE0TlZnRHZCWTVrZWVWeAp0Zz09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0KYu8kH4sIAAAAAAAA/9SYx470xrLn93yK2RcGRW8Wd0HvWfRuR08WXdGbpx90f9KRviNdSTMHGOD2qpHMYP4jojIYv/jfX38ML8rG/2J525UFmaVd/nsV0GVZ2V2WZfCgog+ZoSvZKlUhMjqFhOzHqzCl1oMKCHNpg6naqW4bkTpAhrYOgeaYC9Ct5WCtiPMtS+QPxfdu3tUZXqQhj2cZXbVgYUmCeM967BO5vz1jTl11A38DUpGsPFG4kpuPdCb6YVjrpgV3RyL6ly8pdQR7lRNgb90mD+nHYRx/xlwSMiMQh4qX9cI7dhglQwwoCbBB5g1GZ9CQc+VL5/Rb5+jL4LJDF8avtVvnrF/WIgh4+eNRurym0+0PabXO+r5+8jdtM5XhM3Tlsq1Rp2LXp4iyJQH/u2eZ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"

var vasptest2cert = "CAMSEFtrENn1vXbwd6Q6mxydDbIagAQUhrKURuCAt8F2ceYJhzsRr9AzXxusTSJUJVHo5lX6dpAt19lSoNpR4PXv3YOjr0gAIJNyR4IJ87s04fJrsG1VSzcfzvGW8BSsZ1KIGENmsX0NwYYN43krYWZdVi50V5bNK6qF5N43trnnEAhrX94xCcVkdhL0Sus8EV/osTsEksvZ0GQ+0OCJ6LCweL8bnF82zF+K83cvpWgEOf4EF4gQFSfL3qapcW6UnO9EmoKP2xhA6aLM0nC8ToPOjjjqc/SB/8G5kog6/cEFJPte0H7b8F1R/6tKqHjodq4eQBEexWAEjz8wqXbFAlk8QZouYAolFZ5mQEm3C3IiYoUVN0wElnpc11t4amMgVxYklbhQJL9EY/SBlRpebfxNEgqVi7wmEITxQkVO/S1lDTDkVFAgAWMqdsiJotalf6Pw9unFlHYvic+yhVhtoGWsKSJS3aQu9T6TdizUkizNDW5hMx5MNy9+ZRk3gKDyUBuFTVqL3FaYzht0bTmgfw9oqHnbt6Z6eQSa3YnnrjWSKzTX7k02VKyPizeDc6kFYMgKWYk22rjDGfW3Uhtwh7ArIFNKraywczZCQd+Ppe+2FC3Lmq0A48daEMWj5aaLIrgciC0widRrUhw3X1YbP38IFjeQQ/+o+fnIhguroGV4+gmHi4wsCWz/CU8BY2AIj0p7GhxaOiIKU0hBMzg0LVJTQSoDUlNBMk8KIGh1Yi10cmlzYS5icmFobWEtZGV2LWpwLnN5Z25hLmlvGg9DaXBoZXJUcmFjZSBJbmMyCk1lbmxvIFBhcms6CkNhbGlmb3JuaWFKAlVTOkUKFkNpcGhlclRyYWNlIElzc3VpbmcgQ0EaD0NpcGhlclRyYWNlIEluYzIKTWVubG8gUGFyazoKQ2FsaWZvcm5pYUoCVVNCFDIwMjItMDMtMzBUMDI6NDg6NDNaShQyMDIzLTA0LTMwVDAyOjQ4OjQyWlrcEy0tLS0tQkVHSU4gQ0VSVElGSUNBVEUtLS0tLQpNSUlISERDQ0JRU2dBd0lCQWdJUVcyc1EyZlc5ZHZCM3BEcWJISjBOc2pBTkJna3Foa2lHOXcwQkFRd0ZBREJ5Ck1Rc3dDUVlEVlFRR0V3SlZVekVUTUJFR0ExVUVDQk1LUTJGc2FXWnZjbTVwWVRFVE1CRUdBMVVFQnhNS1RXVnUKYkc4Z1VHRnlhekVZTUJZR0ExVUVDaE1QUTJsd2FHVnlWSEpoWTJVZ1NXNWpNUjh3SFFZRFZRUURFeFpEYVhCbwpaWEpVY21GalpTQkpjM04xYVc1bklFTkJNQjRYRFRJeU1ETXpNREF5TkRnME0xb1hEVEl6TURRek1EQXlORGcwCk1sb3dmREVMTUFrR0ExVUVCaE1DVlZNeEV6QVJCZ05WQkFnVENrTmhiR2xtYjNKdWFXRXhFekFSQmdOVkJBY1QKQ2sxbGJteHZJRkJoY21zeEdEQVdCZ05WQkFvVEQwTnBjR2hsY2xSeVlXTmxJRWx1WXpFcE1DY0dBMVVFQXhNZwphSFZpTFhSeWFYTmhMbUp5WVdodFlTMWtaWFl0YW5BdWMzbG5ibUV1YVc4d2dnSWlNQTBHQ1NxR1NJYjNEUUVCCkFRVUFBNElDRHdBd2dnSUtBb0lDQVFDbXR2Y1NncFZQeC9yc1dXUkJ3NXN6NlY2ZWp0aDJXY0tJSXlUWnhBQnAKVWJsZUVXNVZ5OHVIejc1dElUQkRLNHpNbys4YjVMQ2xMWTh6RDlUWHhEeUdpK0VuK2NCOWdjeUhsQm9vemlkUQpYd3QzWWxGWWsydm51eDFYRUZ2Q0JFRDZEUWx5SklQQ0ltblEyK3FrNFZLQ21ZdTYra2hDSGxRUzR0emN4Q2hHCk5YRC8xNkUwbXIzeDVwVXp4azR0bDZ6bW1kT2cwSjVDNmRYNUdPWDYvNVZTMCtOd3ZmS3ZGQWdXVjBkVW9DdFQKWnJHTlhESk9NZ3B6UC96elRrb2pEYVhWTXZLa2Y5KzBWdml4RHl6WGhmSHVOYnl3dElOOVhBb29qeU9oWXdyNApBait2MmVkTDFtVUVILzAvQUU5bkFXSjhQM1YyTnN1TEpGeFNRT1FlWFhoTnl2ZHJwalNCVWNQQVVZb054am5FCkw2WE1HMXF4ZVdReUt4SVljeEFiRG91N3dYYzVnamxLQkpsaUtHWGdId0t3a3pIWkROZ0luUzBtaDRsZmJXR3YKNDk4RGJxZmxQMUhkWVI0MEhoQWpYbGdPcTVOOGRqSjhpaDZ5SzZxZWEvNTZ3M0hvTG5hZUFuSjR2RVRBenVwYgpaTUZXQnU2TlozS20vYTlUOWpNTHhRdXZTd1FpTWVTVzFZK3I5YlFsendVa3Z1QlREOXhKQkRpS0ltQks0V3RlCk0rN0hMQ3p2c2F2ZExCVitaM0RvanA1L1VIN01EbVhxcUVuNTRSc256NkNiSGJyYmpXT1IwT0tUanR1UzI5bEsKcVNFclVBVUZ4RktSNUZhQThuRVplV1Y0dXZNWWR2SWZkV2pRMlN3VlNjMTBnRUlKcUl4Y1VHdzNCeFRnWlNsTgo2UUlEQVFBQm80SUJvakNDQVo0d0h3WURWUjBqQkJnd0ZvQVVXN3VJenRrWU9jdUxhNEx4QUc5YVpDYmovWFl3CkRnWURWUjBQQVFIL0JBUURBZ1hnTUF3R0ExVWRFd0VCL3dRQ01BQXdJQVlEVlIwbEFRSC9CQll3RkFZSUt3WUIKQlFVSEF3SUdDQ3NHQVFVRkJ3TUJNRlVHQTFVZEh3Uk9NRXd3U3FCSW9FYUdSR2gwZEhBNkx5OWphWEJvWlhKMApjbUZqWlM1amNtd3VhVzkwTG5ObFkzUnBaMjh1WTI5dEwwTnBjR2hsY2xSeVlXTmxTVzUwWlhKdFpXUnBZWFJsClEwRXVZM0pzTUlHWEJnZ3JCZ0VGQlFjQkFRU0JpakNCaHpCUUJnZ3JCZ0VGQlFjd0FvWkVhSFIwY0RvdkwyTnAKY0dobGNuUnlZV05sTG1OeWRDNXBiM1F1YzJWamRHbG5ieTVqYjIwdlEybHdhR1Z5VkhKaFkyVkpiblJsY20xbApaR2xoZEdWRFFTNWpjblF3TXdZSUt3WUJCUVVITUFHR0oyaDBkSEE2THk5amFYQm9aWEowY21GalpTNXZZM053CkxtbHZkQzV6WldOMGFXZHZMbU52YlRBckJnTlZIUkVFSkRBaWdpQm9kV0l0ZEhKcGMyRXVZbkpoYUcxaExXUmwKZGkxcWNDNXplV2R1WVM1cGJ6QWRCZ05WSFE0RUZnUVVuQTkrWEl4S3ZPZ21hdVFEUFNpVlpKWnMxWjR3RFFZSgpLb1pJaHZjTkFRRU1CUUFEZ2dJQkFCU0dzcFJHNElDM3dYWng1Z21IT3hHdjBETmZHNnhOSWxRbFVlam1WZnAyCmtDM1gyVktnMmxIZzllL2RnNk92U0FBZ2szSkhnZ256dXpUaDhtdXdiVlZMTngvTzhaYndGS3huVW9nWVEyYXgKZlEzQmhnM2plU3RoWmwxV0xuUlhsczBycW9YazNqZTJ1ZWNRQ0d0ZjNqRUp4V1IyRXZSSzZ6d1JYK2l4T3dTUwp5OW5RWkQ3UTRJbm9zTEI0dnh1Y1h6Yk1YNHJ6ZHkrbGFBUTUvZ1FYaUJBVko4dmVwcWx4YnBTYzcwU2Fnby9iCkdFRHBvc3pTY0x4T2c4Nk9PT3B6OUlIL3dibVNpRHI5d1FVaysxN1FmdHZ3WFZIL3EwcW9lT2gycmg1QUVSN0YKWUFTUFB6Q3Bkc1VDV1R4Qm1pNWdDaVVWbm1aQVNiY0xjaUppaFJVM1RBU1dlbHpYVzNocVl5QlhGaVNWdUZBawp2MFJqOUlHVkdsNXQvRTBTQ3BXTHZDWVFoUEZDUlU3OUxXVU5NT1JVVUNBQll5cDJ5SW1pMXFWL28vRDI2Y1dVCmRpK0p6N0tGV0cyZ1phd3BJbExkcEM3MVBwTjJMTlNTTE0wTmJtRXpIa3czTDM1bEdUZUFvUEpRRzRWTldvdmMKVnBqT0czUnRPYUIvRDJpb2VkdTNwbnA1QkpyZGllZXVOWklyTk5mdVRUWlVySStMTjROenFRVmd5QXBaaVRiYQp1TU1aOWJkU0czQ0hzQ3NnVTBxdHJMQnpOa0pCMzQrbDc3WVVMY3VhclFEangxb1F4YVBscG9zaXVCeUlMVENKCjFHdFNIRGRmVmhzL2Z3Z1dONUJELzZqNStjaUdDNnVnWlhqNkNZZUxqQ3dKYlA4SlR3RmpZQWlQU25zYUhGbzYKLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQpiliMfiwgAAAAAAAD/1JhH7/PKkt73/BTeC4aYRS5m0cyZYg47JjGIOZOf3vi/7w3n3GP7wjOAgdGyutmlp4F+6lf1P39+DC/Kxv9geduVBZkFLv8rCumyLEkcyzKWU4JDZkApWwG6WOgnoPOdwUZuSiUFNpYGGEz5napvLdIHzADrEADHXJBuLQdrRZxvWSJ/KL53867O8CJAPJ5ldNVChSUJ4j3riDFy/7nGnLrqBv4GpSJVeqJwJTcf6Uz0+8NKf1toeySif/mSUkWoVzoB0eg2dUi/k3H8GXNJyAxQHCpe1glN7DBKhhlIEhC9zBuMzuAh58qXzum3zoHL4EpYR4af2K1z1j9ikN4Ox4fjNR18f/+1Smd9Xz/5G9hMafgMKF32a1Sp2HYppmxJwP9hLXMh9ou0aXfussBUWbecIgeC34uD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"

func reissueSygnaCerts() (err error) {
	// Retrieve Sygna VASPs to edit
	var vasptest1, vasptest2 *pb.VASP
	vasptest1ID := "79246c65-0175-43ae-94c9-6a8d12745c44"
	vasptest2ID := "4ff75b3e-a312-490d-a4c2-f17ab7bb9119"

	if vasptest1, err = db.RetrieveVASP(vasptest1ID); err != nil {
		return fmt.Errorf("could not retrieve vasptest1 record: %v", err)
	}

	if vasptest2, err = db.RetrieveVASP(vasptest2ID); err != nil {
		return fmt.Errorf("could not retrieve vasptest2 record: %v", err)
	}

	// Update the legal person record for each VASP
	vasptest1.Entity.Name.NameIdentifiers[0].LegalPersonName = "COOLBITX LTD. TAIWAN BRANCH (CAYMAN) - TEST (GATETW05)"
	vasptest2.Entity.Name.NameIdentifiers[0].LegalPersonName = "COOLBITX LTD. TAIWAN BRANCH (CAYMAN) - DEV-HUB"

	// Update common name and endpoint for each VASP
	vasptest1.CommonName = "gatetw05.test-travelrule.sygna.io"
	vasptest1.TrisaEndpoint = vasptest1.CommonName + ":443"

	vasptest2.CommonName = "hub-trisa.brahma-dev-jp.sygna.io"
	vasptest2.TrisaEndpoint = vasptest2.CommonName + ":443"

	// Load the identity certificates from protobufs
	vasptest1.IdentityCertificate = new(pb.Certificate)
	vasptest2.IdentityCertificate = new(pb.Certificate)

	var data1 []byte
	if data1, err = base64.StdEncoding.DecodeString(vasptest1cert); err != nil {
		return err
	}

	if err = proto.Unmarshal(data1, vasptest1.IdentityCertificate); err != nil {
		return err
	}

	var data2 []byte
	if data2, err = base64.StdEncoding.DecodeString(vasptest2cert); err != nil {
		return err
	}

	if err = proto.Unmarshal(data2, vasptest2.IdentityCertificate); err != nil {
		return err
	}

	// Cannot validate
	// if err = vasptest1.Validate(false); err != nil {
	// 	return fmt.Errorf("vasptest1 is not valid: %v", err)
	// }
	// if err = vasptest2.Validate(false); err != nil {
	// 	return fmt.Errorf("vasptest2 is not valid: %v", err)
	// }

	if err = models.UpdateVerificationStatus(vasptest1, pb.VerificationState_VERIFIED, "manually reissued testnet certificates", "benjamin@rotational.io"); err != nil {
		return fmt.Errorf("could not update VASP record: %v", err)
	}

	if err = models.UpdateVerificationStatus(vasptest2, pb.VerificationState_VERIFIED, "manually reissued testnet certificates", "benjamin@rotational.io"); err != nil {
		return fmt.Errorf("could not update VASP record: %v", err)
	}

	// Create new certificate requests for the reissuance
	password1 := secrets.CreateToken(16)
	password2 := secrets.CreateToken(16)

	fmt.Printf("password for %s (%s): %q\n", vasptest1.CommonName, vasptest1.Id, password1)
	fmt.Printf("password for %s (%s): %q\n", vasptest2.CommonName, vasptest2.Id, password2)

	var certreq1 *models.CertificateRequest
	if certreq1, err = models.NewCertificateRequest(vasptest1); err != nil {
		return err
	}

	var certreq2 *models.CertificateRequest
	if certreq2, err = models.NewCertificateRequest(vasptest2); err != nil {
		return err
	}

	certreq1.Id = "b6b432d9-0ecf-49c5-a5bd-7c59cc422811"
	certreq1.Params["commonName"] = vasptest1.CommonName
	certreq1.Params["dNSName"] = "gatetw05.test-travelrule.sygna.io;gabojpty.test-travelrule.sygna.io;testtwte.test-travelrule.sygna.io;bitbkrse.test-travelrule.sygna.io;doratwtp.test-travelrule.sygna.io;jmchtw02.test-travelrule.sygna.io;gabotwtp.test-travelrule.sygna.io;gaboaumu.test-travelrule.sygna.io;vasptw99.test-travelrule.sygna.io;gatetw06.test-travelrule.sygna.io;sygnafqn.test-travelrule.sygna.io;testtttt.test-travelrule.sygna.io;sygntw81.test-travelrule.sygna.io;gabocato.test-travelrule.sygna.io;sygnafxm.test-travelrule.sygna.io;sygnaf7s.test-travelrule.sygna.io;sygngbln.test-travelrule.sygna.io;sygnafol.test-travelrule.sygna.io;gatetw11.test-travelrule.sygna.io;sygnafn8.test-travelrule.sygna.io"
	certreq1.AuthorityId = 23
	certreq1.BatchId = 314706
	certreq1.BatchName = "trisatest.net-certreq-b6b432d9-0ecf-49c5-a5bd-7c59cc422811"
	certreq1.BatchStatus = "READY_FOR_DOWNLOAD"
	certreq1.OrderNumber = 314706
	certreq1.CreationDate = "2022-03-29 21:47:00"
	certreq1.Profile = "CipherTrace EE"

	certreq2.Id = "1bc4eb32-6a63-4865-865a-98cefb465891"
	certreq2.Params["commonName"] = vasptest2.CommonName
	certreq2.Params["dNSName"] = ""
	certreq2.AuthorityId = 23
	certreq2.BatchId = 314708
	certreq2.BatchName = "trisatest.net-certreq-1bc4eb32-6a63-4865-865a-98cefb465891"
	certreq2.BatchStatus = "READY_FOR_DOWNLOAD"
	certreq2.OrderNumber = 314708
	certreq2.CreationDate = "2022-03-29 21:48:42"
	certreq2.Profile = "CipherTrace EE"

	if err = models.UpdateCertificateRequestStatus(certreq1, models.CertificateRequestState_COMPLETED, "manual certificate request entry", "benjamin@rotational.io"); err != nil {
		return fmt.Errorf("could not update certreq: %v", err)
	}

	if err = models.UpdateCertificateRequestStatus(certreq2, models.CertificateRequestState_COMPLETED, "manual certificate request entry", "benjamin@rotational.io"); err != nil {
		return fmt.Errorf("could not update certreq: %v", err)
	}

	// Connect to secret manager
	var sm *secrets.SecretManager
	if sm, err = secrets.New(conf.Secrets); err != nil {
		return err
	}

	// Make a new secret of type password
	secretType := "password"
	if err = sm.With(certreq1.Id).CreateSecret(context.TODO(), secretType); err != nil {
		return err
	}
	if err = sm.With(certreq1.Id).AddSecretVersion(context.TODO(), secretType, []byte(password1)); err != nil {
		return err
	}
	if err = sm.With(certreq2.Id).CreateSecret(context.TODO(), secretType); err != nil {
		return err
	}
	if err = sm.With(certreq2.Id).AddSecretVersion(context.TODO(), secretType, []byte(password2)); err != nil {
		return err
	}

	// Update the certreq
	if err = db.UpdateCertReq(certreq1); err != nil {
		return err
	}
	if err = db.UpdateCertReq(certreq2); err != nil {
		return err
	}

	// Append the certificate request to the VASP
	if err = models.AppendCertReqID(vasptest1, certreq1.Id); err != nil {
		return err
	}
	if err = models.AppendCertReqID(vasptest2, certreq2.Id); err != nil {
		return err
	}

	// Update the vasps
	if err = db.UpdateVASP(vasptest1); err != nil {
		return err
	}
	fmt.Println(vasptest1.CommonName + " updated")

	if err = db.UpdateVASP(vasptest2); err != nil {
		return err
	}
	fmt.Println(vasptest2.CommonName + " updated")

	return nil
}

func replaceHodlenaut() (err error) {
	var vasp *pb.VASP
	vaspID := "ac3c0770-3c2a-46a1-ad00-ff30631868bb"
	if vasp, err = db.RetrieveVASP(vaspID); err != nil {
		return fmt.Errorf("could not retrieve hodlnaut record: %v", err)
	}

	// Find the cert reqs for the VASP and delete them all
	var crids []string
	if crids, err = models.GetCertReqIDs(vasp); err != nil {
		return fmt.Errorf("could not retrieve cert req ids: %v", err)
	}

	deleted := 0
	for _, crid := range crids {
		if err = db.DeleteCertReq(crid); err != nil {
			fmt.Printf("could not delete certreq %s: %v\n", crid, err)
		}
		deleted++
	}
	fmt.Printf("deleted %d certificate requests\n", deleted)

	if err = db.DeleteVASP(vaspID); err != nil {
		return fmt.Errorf("could not delete VASP: %v", err)
	}

	fmt.Printf("hodlnaut record with id %s deleted\n", vaspID)
	return nil
}

var hodlnautProdCerts = "CAMSED+bM5PNj0BrKjkeOBhVYQUagAQof8rfgQpv5duHQiCqxcUpAXqu9Jkvs4qFZstMijH1f5YbO7qxV3+Tchj7KEJ4S6KNkD87nQUY9geXpH0AJwIiuy6RJjMjtihOF+AYh3rXdkvTGmjxDnMyvpImOsh3vzSsonCmhsU9DAdl3Z+ZLJxKToe0I/rAf6RbRQtFafPYnZNlSnGGYk2gNy3ZguMtrTTY3uZ/mIpr0BXJVYvZypZ5EXzroclDqFu30Zjh8nmBpADfdSmrT7Z/dvBy+v9WJcEG1pRHIZ4CdFFMoUIQ3g820bptaAp9pXew8nY+VXlsIFKZlsQTBCmqOBNKOIu6GRpLKuBB+gQLsh8Kj6no9ihmC6BLkGb3+2owEZ/cM2tUZxKWzjWqHOZJab6PxjAF4M+AcxZEE/YZkreqUs9sjhJD9xY0xELSUox17VAsG/T7h2D6C00iD9i+dpS0IlA8l/AvHqjPuSW9SeJo/dX7q0v4dQtsYoTj3JiMFfXh4I6rSi6PcXlCDVADoVef5PZTDpMvfQC59HysFl0sJ1dWMe38e3H/4ZeFFKM83Ihw6/deo23BlVieCE/xutMymEEM+P8KVMnrZaGxbW5FVZcwpU3vtt3JBsEeHxSdp4v9/21+YgMWXDRIBSF4az8N775t6fK3MU0GKrM6JxZ/ilUU91DG5vyYAanlGMkdqEX1lc3JyCIKU0hBMzg0LVJTQSoDUlNBMkgKEnRyaXNhLmV4dC5nLW8uY3lvdRoSSE9ETE5BVVQgUFRFLiBMVEQuMg9DbGlmZm9yZCBDZW50cmU6CVNpbmdhcG9yZUoCU0c6RQoWQ2lwaGVyVHJhY2UgSXNzdWluZyBDQRoPQ2lwaGVyVHJhY2UgSW5jMgpNZW5sbyBQYXJrOgpDYWxpZm9ybmlhSgJVU0IUMjAyMi0wNS0yM1QxMzozMzoyOVpKFDIwMjMtMDctMjNUMTM6MzM6MjhaWqwTLS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUc5ekNDQk4rZ0F3SUJBZ0lRUDVzems4MlBRR3NxT1I0NEdGVmhCVEFOQmdrcWhraUc5dzBCQVF3RkFEQnkKTVFzd0NRWURWUVFHRXdKVlV6RVRNQkVHQTFVRUNCTUtRMkZzYVdadmNtNXBZVEVUTUJFR0ExVUVCeE1LVFdWdQpiRzhnVUdGeWF6RVlNQllHQTFVRUNoTVBRMmx3YUdWeVZISmhZMlVnU1c1ak1SOHdIUVlEVlFRREV4WkRhWEJvClpYSlVjbUZqWlNCSmMzTjFhVzVuSUVOQk1CNFhEVEl5TURVeU16RXpNek15T1ZvWERUSXpNRGN5TXpFek16TXkKT0Zvd2RURUxNQWtHQTFVRUJoTUNVMGN4RWpBUUJnTlZCQWdUQ1ZOcGJtZGhjRzl5WlRFWU1CWUdBMVVFQnhNUApRMnhwWm1admNtUWdRMlZ1ZEhKbE1Sc3dHUVlEVlFRS0V4SklUMFJNVGtGVlZDQlFWRVV1SUV4VVJDNHhHekFaCkJnTlZCQU1URW5SeWFYTmhMbVY0ZEM1bkxXOHVZM2x2ZFRDQ0FpSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnSVAKQURDQ0Fnb0NnZ0lCQU9LOC9JNWxMZVMzMmdFSDRqV3ZhN2tLV25sMC85elZRN1N1VTluOEFqRzRvSml3R0FCVAplSXg0US83WDI1TTRNWUJqSEoya080NU9DVHU3N3BxWUo2UG9pbE4yOWVvWStCY2dVL1NJQkpsV3hUZFJWSkxjCjY2UytJemhjMmdyYWZxdDd0VVh0bTlhVkc1U2ZhV3hCSWJGaXBuWkNHSWN5akNQM2Izd1NCSUJ4QmJLbHdpMHAKWEFOQ3pLYW1DUEZ6TGNxT2VKV0lKVDU0dFkyaEJScHRMMlZrdU9Tb1lFZzdySkdPTmkwTkpES0xVYmNGVFkwcQphTWh0bTFVdWdOK3pCMDBXMnlPV0ZualoxZnB3YytCQnA3eisvc2lyNmtKbEtKR0xpTnB5ZEtMSUVHZjZ2Ty9FClZpcFB0a3dacEhON3hpUklXVWdveXVxblNybkhCeFJMSmYxMCsybTNnajZxcktyVTM1U0FtWXZzdlVRdERVZ2sKQ1Y1b2taOVdpYUt2Z01PQlR6d2VoVTgxZTRxRkt5RU5WbmJEZG5mU1lkZjdaVTVKekhEYzl6YUt4bkdDczQ5MApSL3ozM2RVQnFIZ0JtV3Q3aEkzNlZ0SWo0QlJOME1SNlFEcDY0byt1SmlmdGlSUjRsdFZCanVHWTJUdWNVT0JNCkVJdFdXUURsR3FkNGhPeGdxOXQ0ZThTbjBDR3IzWHJONGpuREk1RDV1bE52dGFrSFltcmdKNWFnNVNBdDBRTDIKdmhvOWV5UTU3WjV4ZGk1MUxpdmxRQzBacU9Mc05peXBzNkh0alpRei9Vb1FTaUtpT05MRjNoZjB2WjhRNjNwcApnTXhvRjFLTStOaFNXeXBLRGhLK1ZpaWUyQkpnSitQYzdRMzNJM205Q0RWNko2NHBtZFRJcU05ckFnTUJBQUdqCmdnR0VNSUlCZ0RBZkJnTlZIU01FR0RBV2dCUlp3SXJuLytBQ0RHZDhZaWJCWEdCckdRVkVHekFPQmdOVkhROEIKQWY4RUJBTUNCYUF3REFZRFZSMFRBUUgvQkFJd0FEQWdCZ05WSFNVQkFmOEVGakFVQmdnckJnRUZCUWNEQWdZSQpLd1lCQlFVSEF3RXdTZ1lEVlIwZkJFTXdRVEEvb0QyZ080WTVhSFIwY0RvdkwzUnlhWE5oTG1OeWJDNXBiM1F1CmMyVmpkR2xuYnk1amIyMHZRMmx3YUdWeVZISmhZMlZKYzNOMWFXNW5RMEV1WTNKc01JR0VCZ2dyQmdFRkJRY0IKQVFSNE1IWXdSUVlJS3dZQkJRVUhNQUtHT1doMGRIQTZMeTkwY21sellTNWpjblF1YVc5MExuTmxZM1JwWjI4dQpZMjl0TDBOcGNHaGxjbFJ5WVdObFNYTnpkV2x1WjBOQkxtTnlkREF0QmdnckJnRUZCUWN3QVlZaGFIUjBjRG92CkwzUnlhWE5oTG05amMzQXVhVzkwTG5ObFkzUnBaMjh1WTI5dE1Dc0dBMVVkRVFRa01DS0NFblJ5YVhOaExtVjQKZEM1bkxXOHVZM2x2ZFlJTVpYaDBMbWN0Ynk1amVXOTFNQjBHQTFVZERnUVdCQlNKcmEwS013S3hKV3llS1BjUwpWNURUcHMwRmJ6QU5CZ2txaGtpRzl3MEJBUXdGQUFPQ0FnRUFLSC9LMzRFS2IrWGJoMElncXNYRktRRjZydlNaCkw3T0toV2JMVElveDlYK1dHenU2c1ZkL2szSVkreWhDZUV1aWpaQS9PNTBGR1BZSGw2UjlBQ2NDSXJzdWtTWXoKSTdZb1RoZmdHSWQ2MTNaTDB4cG84UTV6TXI2U0pqcklkNzgwcktKd3BvYkZQUXdIWmQyZm1TeWNTazZIdENQNgp3SCtrVzBVTFJXbnoySjJUWlVweGhtSk5vRGN0MllMakxhMDAyTjdtZjVpS2E5QVZ5VldMMmNxV2VSRjg2NkhKClE2aGJ0OUdZNGZKNWdhUUEzM1VwcTArMmYzYndjdnIvVmlYQkJ0YVVSeUdlQW5SUlRLRkNFTjRQTnRHNmJXZ0sKZmFWM3NQSjJQbFY1YkNCU21aYkVFd1FwcWpnVFNqaUx1aGthU3lyZ1Fmb0VDN0lmQ28rcDZQWW9aZ3VnUzVCbQo5L3RxTUJHZjNETnJWR2NTbHM0MXFoem1TV20rajhZd0JlRFBnSE1XUkJQMkdaSzNxbExQYkk0U1EvY1dOTVJDCjBsS01kZTFRTEJ2MCs0ZGcrZ3ROSWcvWXZuYVV0Q0pRUEpmd0x4Nm96N2tsdlVuaWFQM1YrNnRMK0hVTGJHS0UKNDl5WWpCWDE0ZUNPcTBvdWozRjVRZzFRQTZGWG4rVDJVdzZUTDMwQXVmUjhyQlpkTENkWFZqSHQvSHR4LytHWApoUlNqUE55SWNPdjNYcU50d1pWWW5naFA4YnJUTXBoQkRQai9DbFRKNjJXaHNXMXVSVldYTUtWTjc3YmR5UWJCCkhoOFVuYWVML2Y5dGZtSURGbHcwU0FVaGVHcy9EZSsrYmVueXR6Rk5CaXF6T2ljV2Y0cFZGUGRReHViOG1BR3AKNVJqSkhhaEY5WlhOeWNnPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCmLvIh+LCAAAAAAAAP/MmEfv88qS3vf8FN4ThphFLrzoZs457hjEJCZRlBg+vfF/33vOPdf3zBgDezECtOkmu54iUE/9uv7nzw+Ksmr9D170AlVSeRCIv1YRU1Vl7uJ5aKEN2FUIGtV16Pf1ZAnHld8v26MoWYpaGAALNs9X++xkbscgcHcJCPBETPe9824qRK4ri7sWhZcYmFCUAR6KPDR1l5DeeZx9y5Fe0uCfe/Aw9SCOPkghs00oS2d+iakJ098vtqbjEsOey9EZKVqbEmHjx3Rveuyu/A4miEcm5AmckSzRwnKU+syHWklaeB7Tkypa0IRUIgTqaQrhaV7iZV7maUfzz9plCuWfa4gtzXsViIYJnr+ltSYfYuUh9sCFjRVB0AR8ZC3FWLWlzJ1Z8E+l8DAdxCWOJRt/cnQbl4g+laINpvfe5d9SdfHQ1ADzzOApRREP3UgMP6p4hB5PHfIFMuR3FDMQJ+/ME6s1xoiqeHoyYvaTksO3Cnge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"

var hodlnautTestNetCerts = "CAMSEC56KTFYpezAYWm7n7Lu6aEagAQ/LA1VcvmbWwpvSiTXAyJu1JHVQ8M2EhDDcLdExZtD1fo5YdifX4pMr9AAScl1XtVmUwxnd8Y7mJp5/45eS3dTCWl2pZ0nh+Y/BTraCIP4cvOfq1Yte+BSZlWhHaQFsgldS3lX/ke3HB3qaOgDajFpTI8xG9Bm1UaFju47fQhArobH+1Byb5S6DSYGuU2BjW9GfAZjqbs95CtxTtCcPiEhyykeHfgJx923eQ7WS2Ewu6X68HfNKp0JuarnHZA9HnTxyAIkae0iYxt1EzBLVxryuPjPCmxGvblIoWDxEfhK79QaImeYM54G+mNzU0j8ZHyS4cezaQ3ZdRrtQCxNc6xcEN3NAwSen6vwkK9kJs15mTbqSD7mzoZhmcfkeUGmckeWpX0+pubf3N7XzSVaOFphAlz79OhNDJobenx7jm6Jb1plnFrpAuVawiPm0bGDSynBNEpcbwvKCVMBbDQMc67E5Ck8plSrgCV0RN1v147l7h+pWVSR67SMirX048p5CAPQaa0pWvwPXrS/sWFOoE/u0GRi6pprh8iyo4237fevoTFrtxe74WRJIBPbiVWn5kQacLbanZcSmBLwMLCKTapD84ApvvvQEJ0zuyB3SUJeyJaL3+mW/eQ19h3MsOaEA2W3wKYBfbO2b50bkAOentqs04Tr6JVI0Y88PutUzqeZWSIKU0hBMzg0LVJTQSoDUlNBMkEKEnRyaXNhLmV4dC51LXAuY3lvdRoPQ2lwaGVyVHJhY2UgSW5jMgpNZW5sbyBQYXJrOgpDYWxpZm9ybmlhSgJVUzpFChZDaXBoZXJUcmFjZSBJc3N1aW5nIENBGg9DaXBoZXJUcmFjZSBJbmMyCk1lbmxvIFBhcms6CkNhbGlmb3JuaWFKAlVTQhQyMDIyLTA1LTIzVDEzOjM1OjQ3WkoUMjAyMy0wNi0yM1QxMzozNTo0NlpazBMtLS0tLUJFR0lOIENFUlRJRklDQVRFLS0tLS0KTUlJSERqQ0NCUGFnQXdJQkFnSVFMbm9wTVZpbDdNQmhhYnVmc3U3cG9UQU5CZ2txaGtpRzl3MEJBUXdGQURCeQpNUXN3Q1FZRFZRUUdFd0pWVXpFVE1CRUdBMVVFQ0JNS1EyRnNhV1p2Y201cFlURVRNQkVHQTFVRUJ4TUtUV1Z1CmJHOGdVR0Z5YXpFWU1CWUdBMVVFQ2hNUFEybHdhR1Z5VkhKaFkyVWdTVzVqTVI4d0hRWURWUVFERXhaRGFYQm8KWlhKVWNtRmpaU0JKYzNOMWFXNW5JRU5CTUI0WERUSXlNRFV5TXpFek16VTBOMW9YRFRJek1EWXlNekV6TXpVMApObG93YmpFTE1Ba0dBMVVFQmhNQ1ZWTXhFekFSQmdOVkJBZ1RDa05oYkdsbWIzSnVhV0V4RXpBUkJnTlZCQWNUCkNrMWxibXh2SUZCaGNtc3hHREFXQmdOVkJBb1REME5wY0dobGNsUnlZV05sSUVsdVl6RWJNQmtHQTFVRUF4TVMKZEhKcGMyRXVaWGgwTG5VdGNDNWplVzkxTUlJQ0lqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FnOEFNSUlDQ2dLQwpBZ0VBNFZPeGZielFpLytTbHdKNGNob2VuM21TUW0xcCtLSDVWdi9sd1dNTTJsSUpoYnBDZVJxb2Q2R3hhTWMvClZDejFqTVFxYjR2U2t3ZGo0cmlUVjRvL0hIemlsOTljVHJWMDI3WDdBQllyZ2VDRDBUV3hsREFjemZVTnFmYXYKeHNNNEptTGdUaisyRG4rZTJXdnNFMG1lcDE4bzVabkFMRXFlSG1FNnpKbnN5K0haZ01Na0ZDQWlpK3VHY1lvNQpIcDU0ZHpQZDJlODRLVmo4NmVkaW9Ga0IyNGpHeHMyY3JlN1ZkSkJCankrelpkZXN0czNCYUNPWGxkQmYxYzVpClhwdUNRbkluYWk3UGZZUmVyK2lGdlMyK3cxcTZ4ZkphRFI4WDBSU3FtMUM1dzVZYzUramJNWmpVSDhUbzJZQVYKZFVNQThvdGlYeWNNc1BITUdiZ1NzUUREUE12dmIzUElqY1drUG1DK1VUbmpRS3dadktKUG9TL2tRZDJEdFN0awo4R1htaHgxNjFLWmlpU0ljNU15b1k4Z3M4clRJaWs3ZkJOVzA2QW43YjM5S3ZNRmRDNVFFM1dxcU1YY282d1V2Ck1PYzZERmd6bFVVdEhVOXJEem5VRUZKYW0xRnJSWkI5VnRjVXMxZGFXRXgvc3lVZTdHUy92Mk5jaGVkbERzMzkKVXVIVEY3aXgzbWNpNGhwVzk4TkNGaXJqeHMrQ1M5YlM3OWM2alVtZ2NkaDZmS0d6dUcwTDViaHdVbHVQcG11MwplUmphbEZiUGUxTlVYb2Y4M2JJZGJranF0OHUybzFDaGNvcldDcWoyZFhROU1PWm5UY1YveG81WDFJMllXdG5ZCnNHcWtJRVg3YnVNUmxZNzg0cVZzNXFMQXdVWU96d0ErQWY1MnJ1NEhMUXFISDA4Q0F3RUFBYU9DQWFJd2dnR2UKTUI4R0ExVWRJd1FZTUJhQUZGdTdpTTdaR0RuTGkydUM4UUJ2V21RbTQvMTJNQTRHQTFVZER3RUIvd1FFQXdJRgo0REFNQmdOVkhSTUJBZjhFQWpBQU1DQUdBMVVkSlFFQi93UVdNQlFHQ0NzR0FRVUZCd01DQmdnckJnRUZCUWNECkFUQlZCZ05WSFI4RVRqQk1NRXFnU0tCR2hrUm9kSFJ3T2k4dlkybHdhR1Z5ZEhKaFkyVXVZM0pzTG1sdmRDNXoKWldOMGFXZHZMbU52YlM5RGFYQm9aWEpVY21GalpVbHVkR1Z5YldWa2FXRjBaVU5CTG1OeWJEQ0Jsd1lJS3dZQgpCUVVIQVFFRWdZb3dnWWN3VUFZSUt3WUJCUVVITUFLR1JHaDBkSEE2THk5amFYQm9aWEowY21GalpTNWpjblF1CmFXOTBMbk5sWTNScFoyOHVZMjl0TDBOcGNHaGxjbFJ5WVdObFNXNTBaWEp0WldScFlYUmxRMEV1WTNKME1ETUcKQ0NzR0FRVUZCekFCaGlkb2RIUndPaTh2WTJsd2FHVnlkSEpoWTJVdWIyTnpjQzVwYjNRdWMyVmpkR2xuYnk1agpiMjB3S3dZRFZSMFJCQ1F3SW9JU2RISnBjMkV1WlhoMExuVXRjQzVqZVc5MWdneGxlSFF1ZFMxd0xtTjViM1V3CkhRWURWUjBPQkJZRUZDNmhjVTEzaHJTN0NZU3d4eFIzS05rYmEwVlFNQTBHQ1NxR1NJYjNEUUVCREFVQUE0SUMKQVFBL0xBMVZjdm1iV3dwdlNpVFhBeUp1MUpIVlE4TTJFaEREY0xkRXhadEQxZm81WWRpZlg0cE1yOUFBU2NsMQpYdFZtVXd4bmQ4WTdtSnA1LzQ1ZVMzZFRDV2wycFowbmgrWS9CVHJhQ0lQNGN2T2ZxMVl0ZStCU1psV2hIYVFGCnNnbGRTM2xYL2tlM0hCM3FhT2dEYWpGcFRJOHhHOUJtMVVhRmp1NDdmUWhBcm9iSCsxQnliNVM2RFNZR3VVMkIKalc5R2ZBWmpxYnM5NUN0eFR0Q2NQaUVoeXlrZUhmZ0p4OTIzZVE3V1MyRXd1Nlg2OEhmTktwMEp1YXJuSFpBOQpIblR4eUFJa2FlMGlZeHQxRXpCTFZ4cnl1UGpQQ214R3ZibElvV0R4RWZoSzc5UWFJbWVZTTU0RyttTnpVMGo4ClpIeVM0Y2V6YVEzWmRScnRRQ3hOYzZ4Y0VOM05Bd1NlbjZ2d2tLOWtKczE1bVRicVNEN216b1pobWNma2VVR20KY2tlV3BYMCtwdWJmM043WHpTVmFPRnBoQWx6NzlPaE5ESm9iZW54N2ptNkpiMXBsbkZycEF1VmF3aVBtMGJHRApTeW5CTkVwY2J3dktDVk1CYkRRTWM2N0U1Q2s4cGxTcmdDVjBSTjF2MTQ3bDdoK3BXVlNSNjdTTWlyWDA0OHA1CkNBUFFhYTBwV3Z3UFhyUy9zV0ZPb0UvdTBHUmk2cHByaDhpeW80MjM3ZmV2b1RGcnR4ZTc0V1JKSUJQYmlWV24KNWtRYWNMYmFuWmNTbUJMd01MQ0tUYXBEODRBcHZ2dlFFSjB6dXlCM1NVSmV5SmFMMyttVy9lUTE5aDNNc09hRQpBMlczd0tZQmZiTzJiNTBia0FPZW50cXMwNFRyNkpWSTBZODhQdXRVenFlWldRPT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQpiyiIfiwgAAAAAAAD/1NhHD+NYkiDgO3/F3oWF6M1hDvROpOjdjd57z1+/yMyq6qqZ7mkMClhgdHyGoSD04n2K//vjw/CirP8flrccWZBZ2uF/jgKaLEtcw7KMEZf0KTN0KZufYZw0r+4IjaniZC/WnZhGh9aZsp2rthapE2Ro8xRojrkBzVxP1gw5zzRF/lQ89+EdjeFFGnJ5ltFUExbW2I+OtMem0PnHHHNpquN7O5CIZOmKwh0/fKgx4a+NlWaYcHfGond7klKFsFvaPtZoFnlKv4Jx/BVxccCMQBQobtoLTWQzSoroUOxjg8zrjMagAefIt8a5t/bwj/a4oA6NP8YejQv/GAP0bjyThv9odPvrq1Ua63naxT+0xZS6x9Clw7Z6lYhdnyDKHvv8n+ZSB2BbqEv665AFpkr79RI52v81OTocqE+pWHVpZ92hr3cy3+3hwyca8ysYfWk2kEnKlML8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"

func updateHodlnautP2() (err error) {
	// Determine if we're testnet or prod
	var (
		directory      string
		vasp           *pb.VASP
		certreq        *models.CertificateRequest
		pkcs12password string
	)
	hodltest := "5b749854-bdb5-4874-8ad7-b85fe1d68092"
	hodlmain := "17068f9b-9014-463f-9c93-2cdc9733d05d"

	for _, vaspID := range []string{hodltest, hodlmain} {
		if vasp, err = db.RetrieveVASP(vaspID); err != nil {
			continue
		}
		directory = vasp.RegisteredDirectory
		break
	}

	if directory == "" || vasp == nil {
		return errors.New("could not find Hodlnaut record in directory")
	}
	fmt.Printf("updating %s VASP %s\n", directory, vasp.Id)

	if directory == "vaspdirectory.net" {
		vasp.CommonName = "trisa.ext.g-o.cyou"
		vasp.TrisaEndpoint = "trisa.ext.g-o.cyou:443"
		vasp.IdentityCertificate = new(pb.Certificate)

		var data []byte
		if data, err = base64.StdEncoding.DecodeString(hodlnautProdCerts); err != nil {
			return err
		}

		if err = proto.Unmarshal(data, vasp.IdentityCertificate); err != nil {
			return err
		}

		if certreq, err = models.NewCertificateRequest(vasp); err != nil {
			return err
		}

		certreq.Id = "90154d56-6b10-4e66-94d4-a35c19b69437"
		certreq.Params["commonName"] = vasp.CommonName
		certreq.Params["dNSName"] = "trisa.ext.g-o.cyou;ext.g-o.cyou"
		certreq.AuthorityId = 93
		certreq.BatchId = 318886
		certreq.BatchName = "vaspdirectory.net-certreq-manual-90154d56-6b10-4e66-94d4-a35c19b69437"
		certreq.BatchStatus = "READY_FOR_DOWNLOAD"
		certreq.OrderNumber = 318886
		certreq.CreationDate = "2022-05-23 08:33:29"
		certreq.Profile = "CipherTrace End Entity Certificate"

		// TODO: it's better to put the password directly into secrets than add it here
		pkcs12password = ""

	} else if directory == "trisatest.net" {
		vasp.CommonName = "trisa.ext.u-p.cyou"
		vasp.TrisaEndpoint = "trisa.ext.u-p.cyou:443"
		vasp.IdentityCertificate = new(pb.Certificate)

		var data []byte
		if data, err = base64.StdEncoding.DecodeString(hodlnautTestNetCerts); err != nil {
			return err
		}

		if err = proto.Unmarshal(data, vasp.IdentityCertificate); err != nil {
			return err
		}

		if certreq, err = models.NewCertificateRequest(vasp); err != nil {
			return err
		}

		certreq.Id = "c646d447-2837-4fd1-b4d0-7536d666a304"
		certreq.Params["commonName"] = vasp.CommonName
		certreq.Params["dNSName"] = "trisa.ext.u-p.cyou;ext.u-p.cyou"
		certreq.AuthorityId = 23
		certreq.BatchId = 318887
		certreq.BatchName = "trisatest.net-certreq-manual-c646d447-2837-4fd1-b4d0-7536d666a304"
		certreq.BatchStatus = "READY_FOR_DOWNLOAD"
		certreq.OrderNumber = 318887
		certreq.CreationDate = "2022-05-23 08:35:47"
		certreq.Profile = "CipherTrace EE"

		// TODO: it's better to put the password directly into secrets than add it here
		pkcs12password = ""
	} else {
		return errors.New("unhandled directory")
	}

	// Update audit logs on certificate request and VASP
	if err = models.UpdateVerificationStatus(vasp, pb.VerificationState_VERIFIED, "manually reissuing certificates with extended SANs", "benjamin@rotational.io"); err != nil {
		return fmt.Errorf("could not update VASP record: %s", err)
	}

	if err = models.UpdateCertificateRequestStatus(certreq, models.CertificateRequestState_COMPLETED, "manual certificate request entry", "benjamin@rotational.io"); err != nil {
		return fmt.Errorf("could not update certreq: %v", err)
	}

	// Create a secret for the pkcs12 password, just in case
	// Connect to secret manager
	if pkcs12password != "" {
		var sm *secrets.SecretManager
		if sm, err = secrets.New(conf.Secrets); err != nil {
			return err
		}

		if err = sm.With(certreq.Id).CreateSecret(context.TODO(), "password"); err != nil {
			return err
		}
		if err = sm.With(certreq.Id).AddSecretVersion(context.TODO(), "password", []byte(pkcs12password)); err != nil {
			return err
		}
	}

	// Update the certificate request
	if err = db.UpdateCertReq(certreq); err != nil {
		return err
	}

	// Append certreq to the vasp
	if err = models.AppendCertReqID(vasp, certreq.Id); err != nil {
		return err
	}

	// Update the VASPs
	if err = db.UpdateVASP(vasp); err != nil {
		return err
	}
	fmt.Printf("%s with cert req %s udpated\n", vasp.CommonName, certreq.Id)
	return nil
}

func reissueRotational() (err error) {
	var (
		vasp           *pb.VASP
		certreq        *models.CertificateRequest
		pkcs12password string
	)

	// Step 0: Get Rotational's VASP ID from the Admin UI
	vaspID := "0ffe693f-9752-45cb-830f-7dbae12d6baf"

	// Step 1: Fetch the VASP record
	if vasp, err = db.RetrieveVASP(vaspID); err != nil {
		return fmt.Errorf("could not find rotational VASP record: %s", err)
	}

	// Step 2: Create a CertificateRequest
	if certreq, err = models.NewCertificateRequest(vasp); err != nil {
		return fmt.Errorf("could not create certificate request: %s", err)
	}

	// Step 2b: mark the certificate request as ready to submit for CertMan
	if err = models.UpdateCertificateRequestStatus(
		certreq,
		models.CertificateRequestState_READY_TO_SUBMIT,
		"manually reissuing certificates",
		"support@rotational.io",
	); err != nil {
		return fmt.Errorf("could not mark certificate request ready to submit: %s", err)
	}

	// Step 3: Create a PKCS12 password and print it out
	var sm *secrets.SecretManager
	if sm, err = secrets.New(conf.Secrets); err != nil {
		return fmt.Errorf("could not connect to secret manager: %s", err)
	}

	secretType := "password"
	pkcs12password = secrets.CreateToken(16)
	fmt.Printf("PKCS12 Password is: %q\n", pkcs12password)

	ctx, cancel := context.WithTimeout(context.Background(), 5*time.Second)
	defer cancel()

	if err = sm.With(certreq.Id).CreateSecret(ctx, secretType); err != nil {
		return fmt.Errorf("could not create password secret: %s", err)
	}
	if err = sm.With(certreq.Id).AddSecretVersion(ctx, secretType, []byte(pkcs12password)); err != nil {
		return fmt.Errorf("could not create password version: %s", err)
	}

	// Save certificate request to database
	if err = db.UpdateCertReq(certreq); err != nil {
		return fmt.Errorf("could not save certreq: %s", err)
	}

	// Step 4: Save certificate request on VASP
	if err = models.AppendCertReqID(vasp, certreq.Id); err != nil {
		return fmt.Errorf("could not append certreq to VASP: %s", err)
	}

	if err = db.UpdateVASP(vasp); err != nil {
		return fmt.Errorf("Could not save vasp: %s", err)
	}

	return nil
}
