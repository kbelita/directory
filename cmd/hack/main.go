/*
Hack to try to reissue certificates and correctly update alice and bob.
*/
package main

import (
	"bytes"
	"context"
	"crypto/x509"
	"encoding/base64"
	"encoding/pem"
	"fmt"
	"log"
	"time"

	"github.com/joho/godotenv"
	"github.com/trisacrypto/directory/pkg/gds/config"
	"github.com/trisacrypto/directory/pkg/gds/models/v1"
	"github.com/trisacrypto/directory/pkg/gds/secrets"
	"github.com/trisacrypto/directory/pkg/gds/store"
	pb "github.com/trisacrypto/trisa/pkg/trisa/gds/models/v1beta1"
	"github.com/trisacrypto/trisa/pkg/trust"
	"google.golang.org/protobuf/proto"
)

var (
	db   store.Store
	conf config.Config
)

func main() {
	// Load the dotenv file if it exists
	godotenv.Load()

	var err error

	// Load the configuration from the environment
	if conf, err = config.New(); err != nil {
		log.Fatal(err)
	}
	conf.Database.ReindexOnBoot = false

	// Connect to the trtl server and create a store to access data directly like GDS
	if db, err = store.Open(conf.Database); err != nil {
		log.Fatal(err)
	}

	// JOB 1: update the Alice and Bob records if we're on the TestNet.
	// if err = updateRobotCerts(); err != nil {
	// 	log.Fatal(err)
	// }

	// JOB 2: reissue certificates for NMS
	// if err = reissueNMSCerts(); err != nil {
	// 	log.Fatal(err)
	// }

	// JOB 3: reissue certificates for Sygna
	if err = reissueSygnaCerts(); err != nil {
		log.Fatal(err)
	}
}

func updateRobotCerts() (err error) {
	names := map[string]string{
		"alice": "7a96ca2c-2818-4106-932e-1bcfd743b04c",
		"bob":   "9e069e01-8515-4d57-b9a5-e249f7ab4fca",
	}

	for name, vaspID := range names {
		// Lookup the VASP record
		var vasp *pb.VASP
		if vasp, err = db.RetrieveVASP(vaspID); err != nil {
			return fmt.Errorf("unable to retrieve %s record: %v", name, err)
		}

		// Unmarshal the identity certificate
		var data []byte
		if data, err = base64.StdEncoding.DecodeString(certs[name]); err != nil {
			return fmt.Errorf("could not deocde base64 for %s: %v", name, err)
		}

		vasp.IdentityCertificate = new(pb.Certificate)
		if err = proto.Unmarshal(data, vasp.IdentityCertificate); err != nil {
			return fmt.Errorf("could not unmarshal %s certificate: %v", name, err)
		}

		// Update the VASP status as verified/certificate issued
		if err = models.UpdateVerificationStatus(vasp, pb.VerificationState_VERIFIED, "manual certificate reissuance", "benjamin@rotational.io"); err != nil {
			return fmt.Errorf("could not update VASP verification status %s: %v", name, err)
		}
		if err = db.UpdateVASP(vasp); err != nil {
			return fmt.Errorf("could not update VASP %s: %v", name, err)
		}

		// Create certificate request for the issued certs
		if err = db.UpdateCertReq(certreqs[name]); err != nil {
			return fmt.Errorf("could not save certificate request for VASP %s: %v", name, err)
		}
	}
	return nil
}

var certs = map[string]string{
	"alice": "CAMSEGC53MBF1ZYImUrSF5/EpEQagAREgXemG6RJ3ubLvYAWNpGZIPCEvMaUseoboRQOcFkze0teJTyJsOgl0tbR5R3jerVSn1UfZzrVmj4A2rGSS/SJa/9x1/YzSO7J1utTXU+/lDUcWGWOZ3X/QOFomifWg3KfgDuB2j4dgALWtwdSidOTXrm8Sxsj0fJTGpiG6Usr8Hkft7FkFxa8hhG0GHbxPljW/GZ6u8lTtUCaSWmmM6rA3ixiI55wxxH4xC9EknM9PTzL1yTumx58Xf6ogCsMPPJHH5AcSuK3wTl0809Lx4pR0o8w0SX0E8t/pqm4/WyKxSnVCjn2v0q/ThM6lYlY0q2f5MwXtG3yGOzH2duBwjpQ3L8N5/n+Jf+GWoE7Rh/ClPKlEh/hHjtnwD/9CXykHMFMXLHQAaziE9n8UaYQ9X77vqnE/QYwjtMfK9OY+NV6lzhq6tGk9Ed2oqVdJQtGvZOO9QfGzQWKzNpfncbSXS+eLrjtzQB7VOhxJyfGajBRg93xjvd8ZDscS2I0SVriZ0UxGzpfJEEZmpYu6BdM0637gr+TBYPAPayFo4iDYXxfravpO6PTPZxQAwOtoouvw7R+p5/06jtzIqYVCu1vJAf3L2XIdIo1Kbdxjlqfv1fGGe9TlA1CCY0l/IsMVTKUElO9J5k/wDiACdNEIyXNclbccDhiWDIBESKSTAp7YRQxsiIKU0hBMzg0LVJTQSoDUlNBMkQKFWFwaS5hbGljZS52YXNwYm90Lm5ldBoPQ2lwaGVyVHJhY2UgSW5jMgpNZW5sbyBQYXJrOgpDYWxpZm9ybmlhSgJVUzpFChZDaXBoZXJUcmFjZSBJc3N1aW5nIENBGg9DaXBoZXJUcmFjZSBJbmMyCk1lbmxvIFBhcms6CkNhbGlmb3JuaWFKAlVTQhQyMDIyLTAyLTI4VDE3OjM5OjM4WkoUMjAyMy0wMy0yOFQxNzozOTozN1pawBMtLS0tLUJFR0lOIENFUlRJRklDQVRFLS0tLS0KTUlJSEJqQ0NCTzZnQXdJQkFnSVFZTG5jd0VYVmxnaVpTdElYbjhTa1JEQU5CZ2txaGtpRzl3MEJBUXdGQURCeQpNUXN3Q1FZRFZRUUdFd0pWVXpFVE1CRUdBMVVFQ0JNS1EyRnNhV1p2Y201cFlURVRNQkVHQTFVRUJ4TUtUV1Z1CmJHOGdVR0Z5YXpFWU1CWUdBMVVFQ2hNUFEybHdhR1Z5VkhKaFkyVWdTVzVqTVI4d0hRWURWUVFERXhaRGFYQm8KWlhKVWNtRmpaU0JKYzNOMWFXNW5JRU5CTUI0WERUSXlNREl5T0RFM016a3pPRm9YRFRJek1ETXlPREUzTXpregpOMW93Y1RFTE1Ba0dBMVVFQmhNQ1ZWTXhFekFSQmdOVkJBZ1RDa05oYkdsbWIzSnVhV0V4RXpBUkJnTlZCQWNUCkNrMWxibXh2SUZCaGNtc3hHREFXQmdOVkJBb1REME5wY0dobGNsUnlZV05sSUVsdVl6RWVNQndHQTFVRUF4TVYKWVhCcExtRnNhV05sTG5aaGMzQmliM1F1Ym1WME1JSUNJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBZzhBTUlJQwpDZ0tDQWdFQXhWZVpjdGJ5YzhWL3MwUW5MZXRpOEJ1ekJiMWR0cDhMTzVETHBzUHd6dHR5VWNIZWNpZ0NjNjNKCk9wR0VpSVh4dHI0T1BRN2Z5bHNkd3dTQ1ZDUEtRNVByZGJHYzlwQW1LTUk0Nm9TTjN2OWQ3dFRXSm5wMFladlcKUytadXJYNVRoL0RyakJGZ2ZTdnhkVVZrQTVpcjJtcStrUUt6bkQvTlFXbU9ETXhqdFh6MHFWaWQrQlk0S2c3awpEd2JHY0VUL3FoR0lJTFh1N2NGK0oya3FUenFEM2pnaEVkOGxOMllTdm5ySXdYbkNaRjJEZVRINDVBTmtLeHpTCmw3d0owY2lBU1pvZUZKUDRNdjNFdEJ5UHBKWnRuMlZlWlJETktGNzdaMTVMYkdTOFl3QUJMZUNyUzhIV1ZGVk0KMGFBUlNkWjRpYkJudWxockdUdkJTdmpVQWtmbXpsSmVKSitNQWxvQ0tRazFKVy8xTElReTNtczhHNlVXZWJqVQpZelBxT3RDdTN5TFJVeDNmQzM4ZzNvRnFibmlxdUYySVpQWThueGVBak1COS9iWGZWVlltWXpPSHhWQW0yMG5MCm9LR0ZrVkx0NWptYlNTb0xOMGtZNEtuN1Q5dFZ4TzMzcTlpaGtQTnl4SlIzeDBwQzFoT05LU1JUb2dXeEpsSXQKM01XYkUxZCtGMGlPd0NjMTk2ZlpOdG9seVlpTW1jK05Sd2lpdC8vc0Q4R3dabkU5UzRpQzcwTTc3bTdzNGE1cQpjN2tKNHlIdnJSb3p2SEhSQnFqdEdMbXArQ0dNVW9CUVk2SVJhMUxMeVRWbjA5SmVMdGoxejlhNDFyNVoyeHppCmJKcHZiQnN2Vzh3Q2U2cHpVb2JOd2RBbjhBaEt1NTAzV1laSjNqRWVOUW8rVWJ3Q01lOENBd0VBQWFPQ0FaY3cKZ2dHVE1COEdBMVVkSXdRWU1CYUFGRnU3aU03WkdEbkxpMnVDOFFCdldtUW00LzEyTUE0R0ExVWREd0VCL3dRRQpBd0lGNERBTUJnTlZIUk1CQWY4RUFqQUFNQ0FHQTFVZEpRRUIvd1FXTUJRR0NDc0dBUVVGQndNQ0JnZ3JCZ0VGCkJRY0RBVEJWQmdOVkhSOEVUakJNTUVxZ1NLQkdoa1JvZEhSd09pOHZZMmx3YUdWeWRISmhZMlV1WTNKc0xtbHYKZEM1elpXTjBhV2R2TG1OdmJTOURhWEJvWlhKVWNtRmpaVWx1ZEdWeWJXVmthV0YwWlVOQkxtTnliRENCbHdZSQpLd1lCQlFVSEFRRUVnWW93Z1ljd1VBWUlLd1lCQlFVSE1BS0dSR2gwZEhBNkx5OWphWEJvWlhKMGNtRmpaUzVqCmNuUXVhVzkwTG5ObFkzUnBaMjh1WTI5dEwwTnBjR2hsY2xSeVlXTmxTVzUwWlhKdFpXUnBZWFJsUTBFdVkzSjAKTURNR0NDc0dBUVVGQnpBQmhpZG9kSFJ3T2k4dlkybHdhR1Z5ZEhKaFkyVXViMk56Y0M1cGIzUXVjMlZqZEdsbgpieTVqYjIwd0lBWURWUjBSQkJrd0Y0SVZZWEJwTG1Gc2FXTmxMblpoYzNCaWIzUXVibVYwTUIwR0ExVWREZ1FXCkJCUnovb2s3TW5yM25Pbzh6N0xhTmtEWlc5L2pzekFOQmdrcWhraUc5dzBCQVF3RkFBT0NBZ0VBUklGM3BodWsKU2Q3bXk3MkFGamFSbVNEd2hMekdsTEhxRzZFVURuQlpNM3RMWGlVOGliRG9KZExXMGVVZDQzcTFVcDlWSDJjNgoxWm8rQU5xeGtrdjBpV3YvY2RmMk0wanV5ZGJyVTExUHY1UTFIRmhsam1kMS8wRGhhSm9uMW9OeW40QTdnZG8rCkhZQUMxcmNIVW9uVGsxNjV2RXNiSTlIeVV4cVlodWxMSy9CNUg3ZXhaQmNXdklZUnRCaDI4VDVZMXZ4bWVydkoKVTdWQW1rbHBwak9xd040c1lpT2VjTWNSK01RdlJKSnpQVDA4eTljazdwc2VmRjMrcUlBckREenlSeCtRSEVyaQp0OEU1ZFBOUFM4ZUtVZEtQTU5FbDlCUExmNmFwdVAxc2lzVXAxUW81OXI5S3YwNFRPcFdKV05LdG4rVE1GN1J0CjhoanN4OW5iZ2NJNlVOeS9EZWY1L2lYL2hscUJPMFlmd3BUeXBSSWY0UjQ3WjhBLy9RbDhwQnpCVEZ5eDBBR3MKNGhQWi9GR21FUFYrKzc2cHhQMEdNSTdUSHl2VG1QalZlcGM0YXVyUnBQUkhkcUtsWFNVTFJyMlRqdlVIeHMwRgppc3phWDUzRzBsMHZuaTY0N2MwQWUxVG9jU2NueG1vd1VZUGQ4WTczZkdRN0hFdGlORWxhNG1kRk1SczZYeVJCCkdacVdMdWdYVE5PdCs0Sy9rd1dEd0Qyc2hhT0lnMkY4WDYycjZUdWowejJjVUFNRHJhS0xyOE8wZnFlZjlPbzcKY3lLbUZRcnRieVFIOXk5bHlIU0tOU20zY1k1YW43OVh4aG52VTVRTlFnbU5KZnlMREZVeWxCSlR2U2VaUDhBNApnQW5UUkNNbHpYSlczSEE0WWxneUFSRWlra3dLZTJFVU1iST0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQpizyIfiwgAAAAAAAD/zJjH8utKkt73eArtGQrCm8UsCt4T3u3gCA8QIPzTK/7n3L59e6ZnRlJHKMRllkl+hagvf5X/8+fHCpJi/g9OcDxFVDjgCb+ikKEoMttyHPsiK3AoLKgUO9bH/BCioK+axF2VaKTdzuGByVbdXHeNxBwwC+xDBDx7QYb9PTg75gPbloRDDfxb8AxWkADiCxxraDYqftMw2fOB+MTe38fY09C8MNigTKIrXxKv9BZig41/L6wNy0b7I5WCK5DVOkb9yg2J1nDoQ/6djBfOhE8jdoKSSPXzQWwTl1VzzETSkBgVwWQNFo94T7kMXrlevIAZd3e/xOkndhu88WcMMpHpyD1BN0D3+6/VBhcExincwGErM2BB5XGdWWdSP2SYuqWh8Jex3IO4Dumz4dwVka3z4XtKPAh/D04eD5ufXKr7vHeuODR7Rei3+BZKgz1+JQOnEUBxxH704eegzF4fkzrH2CbD7C0bAthQFE5p//3pCyIALw5UNPgZh7hK40AlgDMok3zNrpwOnl/YHvVybWh2u9kMKdYPrb8IXv98reNe18vP5TJvKi4nMRV6fSShUaJzXfCXZVPvq/8Wx+FyAWdpNmEtRSblzAcMmqHg5OSa2M4U1OqF6viB42QPIfeRbEtEePWTX1pWrN7ufhZ+0AGiWdBhfnS2do/807TD4cUbZ7tGNzwHTfFgY1yrqA7ij0zKBe8515Ki6NFG5eJDRbvZu2cea6taKOjeRGN3HxfliEYuEVG+9GScAGannbcL9dShwnkD3GQqRdXCjR0TVvayPmqyjmhQJg5vaiJFJQihZ5JLxwdg9ZJbXFoOAzEwIDgFjlskeJOx49bXi+TtrLu3Pujew92rpao+DNBPnGZ3iBo+EV2xL2z40hLph2XW+lB8W/Nr5Tbs0h3/xN4cRlfYJM7Z2MybiCqJFdPjWYLWYJlnFr2DIB7i+yWfARhQeNShSZPELtBXoh0y1510E+5iXBspj1mD84VhM9PUnWVep+pgJ/zhkPplaq7jTVV4qr2yQpgRZgJSPES4eR1cjjDkOzHXqb/ixhjyh+kcTbM+n1+elo5kFBgXbzgKNihqoL54SsxQTnUqfsn74kz3LssOO7erpA+fBycZ/sTaMak4KaLrlxeMMKOW+toiN5PiyEIk6Hk3UKZ+9oz97iF9cCX5uf0pM48CjDSotY2AsTBOVKwVStOeHn52cEZJc+AQAEhfHEjyA6oqyTNY+udyFMphxwabAlHcqMagEokf9QbdONpm93CwB/yJoAbAf83lD4F9HrYAgUMRcR4YPzdQdgwWvGkBtAAYHPg1UbV/TQwN1pY47isB2xfZw+DYqlrYShAh1s554LHB7w1owWtZwxDmytVYqe6cqZCd49XQe/yHQxW/HWqLMfWrD/0OFRxxJ6EJp2Gx64O5Zy7zy6r+dCq/3wopuLIw6NJQhBPfZPXBvDKeY/sjViDtiFnW9mVgC0IVT0cV54cPYuVvcQNokiPVcCEDUr+Y9o/N4d82SLRQPtpbGjKwPpp9jDmfBKW3GGVW/d+5kRsScBKpaxI6nzhyehsWfmTAkMEbfz+cG7B1U/ynujPUvHOO+Pw4Vo4GbSH1I5RdRJuh8KGAmA8c2GHZ7hBxJfgvrY6Ff3/Kyg4hlnXu59RRxrhg42uib0pPzY5PQubZfu9/Uo1++aEAHEXEPvXWQW5BDReFArFNncHlj1q/pV6XZ4kUfH5kEwNb9ajx6SbjJ7XQQ7j0CxybEf/DBDKakxCSTA9gzmfX7XAT7s+8eKMG3G5XkS0+glg7YSOyWPftUCBPmK9TdRqRybxGHFBVMT0gOQYcsuSyP41eh5DELnwzhZEv/5zjeut17ckSMlWeCZuHuxI7K1ujtEfEyH4O5bKrkE8FYOj6z6d9zYeJf+PmVeZG7jwMe3dU9bY8mL6YvKM+3/ItYo9ZAQvP35dzPmxZWBpopQWisEzLpUvNLzTLMIWeYS39TaafzUK+zdf/IPZEMAuj7TDuvT6hGpraOj48Q6ScFaLr9nsyY1blCumb15Mv38SziZ51P7MvOH4fH+/6OMobd3AqocHzaff0h71ZT7xOGEhfCK+t5ClKg2AFjwdFfk4LlgyF8uRr9warDcpPjqfb4nwsRy5mrY9cX3cW1Gt3Xz6/sAg13zuNCEyCe3gfGxKnchiUiDflbj6ew3T4sVXQMYW9JZuShbUxhT7Fh0I0nC8ZXQ4LSckc6lsVeeZrfeDasztC/uDRb52+lAoV6YhEF9LbWvhGcx8Y/JJq+kK/4PdcvpnXREH5pQ2ivazZZcvMxfSX7GqmO2B5TKQjxURnPe4+YZt2NZjq+9J50b96VvV2t0wsGuBQBUbP4Yz+jtQQkwEe99UFHKHpukMrUcE3MuXfoF88Jpj8f2S0/4bfpJnnOFbl/uQ34ynCwodKyuVLjqu5kw9dOL1/ym/7/2t+Ow6p+hu/mf+B39wMZeC/s5tAGHx3ma0AGx64jf6H3Yx/jAXTAeXt/z27/aAb9H/Ibu8/fOqH3cIfmdA/6IzMuwj7LblY3vY4DjTKwduxqk2JUu+5CWyBZW3AV5ViAZ7jQDVxUFUpLFBxzU+QtMwTun45LNpTPEkNMkXgp7hvtC8UkaoaGh0+hOElED4ZR1qFByOjqdCQL/iXkwZUufGBeoVlx6E+jLV4gN2VaKVMFQ1O6DKBSLA2+ZzDZ4Apry0ReVmCx+gNyUK7fZ2X8q489Ry+LBGEcSMry5FbtYVKchLk8sk5wKLYvINtUYlslYA1UhcY64EyFDQYWPm5FG3CBw5ReTINq4Z6VQk8Wc71EfUDIx5i+RIextd6pzahmIyYY4UbO+1gzoICfUjZ1GZjKOE4nhIDsWP/6izyJQZWcfLImKYwSL1p6Ag5IaOhAafAus62FKyKdeYqQ8Woph0dBVZ1mn1jayGSIHaG56S06qHg5fhkamd6jQcu57CAWPY0FX7NGs48NwP5TiEJpfRRNaWFeoSCeSxsxH+beyg+h3Ohgt3xo1tjSNzd7yqlZXmQr26w4qi/2hee0/kK0ZuVt3uiOZmuYuHqG1LHTuS4FUyPjDgdsE8qvblLWc7HY1uHh1HfUbY8vkYeHA+X0SCSDBdtsbvhTt27pBS+e9vKfufD9rIVRJ80jGpF5xXedsHI7Q6TmOyXxeU+oqEGCklDyvrwX2aChB/VoARuWuU3N8WpWqDDyBdO/JiXxVMtin52GVq+EIykpslUZhChTQJQBnrgSa5UjsGUbvvlPJ6Co7eP3MbOkBx2Os1WXryoJt5l5Kjr9AioDBYAqa0qgTIUhYXMG7x/kZNrCD+XqWI92XB6zMkrQJZZo4slXMF2NTWCUt/g9WuuTf/CNBYYHATi+BCqX9TgAVt+sqA62OqH2RQW8Kz6NyyzWxYYPFlZGiDrtv4TT6B/ymX/DQj5A7MXwm8Mg344rLb/jls/GFZ6LGYI9l+hiPtr1r8mhf7I+t/i11+zFjzY/4qgB4jjNpUdOOenXUf/WDj+XqgPTJtj4E/c+htt/XocO/ALYtlY+K+pGZY4d5ZcJcN4W2B54AOAKxywWXN3ugaaHS5fbbWA+36IN+8hd5i/3q6siHV8aXyzTf0l3z1Webenzx1xlrO1qo+7Hg7BSRwBWuLpljCcAj7GwlHefQaZjRLp8lxPiy8QkkctqZ6ePOlrHcTEs67RUAtPiB03dix9h3AyjKt8hleTGhGGddUwgNFuNSpK87MDP/q36stdSZNqHvfL8HGDkWsCc1pH3pHr3oPMQClCknQcKa7EF1IZBz9ujfZhu51+Ucc8vufeI9ryblG3e3vURs24/EL0bzkWU4UIkPUVMHpCmTRPz12LXtPnPd9po0pvuv1wIXBVlwjoQxGjtdn9lbd4EZeYRFq+nl/2wwxJw5dWysYFuvZm6/kadX7FSxmdbyrvAetpWDaFcDSpOZrS5SbDCfPBMoYx6K64+y8FSSP/IHyGQhouDoBHRMXE2rS41vDUckE93nf4ian2yjgrabYnbm4DXauwoukU4yGnCi1ZXJbsQbSCcYMLKZg2PF8LpWzriiIhSjxoWpRqu8EAAu9G9YHFUi1FFlkI8614HQxpfGpJuofYmT8aJl9ua5nV7U3TWEHbamguXPV4fHeNtL9Otd8URQFef5sldtjj5/soofqNBhuvMJShJV63dgGSvB4lkgmzZ4szQmRN5EU9vWj9NnF0tliemkXqCoutVr69twc9ncLX9CbikJWvzCnM82lbtKc/BYx1yxhI3k9nO/7tXyAocfmpw4T7J0FFzySveETvnV08Z+R+P06C/Wdvjv+PCYoD/0hQvHEZ/RTzt3KYXne8PAU1PPswbuWEwpbd/xUZ0I+Of0UG9A/P47/K+N/ofnGVxkE/T79r37osp6+Q4cVnGsUc5h9WxbJzTn+p2uMs47F3QmC/Wo5Z++eJYReGlpppkvoBZXOwZUi8TVjyaZUMCVaGJ5tp27oKPakHc2F5otIrnX9wSbK5xC1vhOjl7vBOtTKmDrqKl1AjhCssBDCS8MNLWGYiUu7bWzVKxVtMe1Q63ufEckzkPeeHc4lYZ9W66VzwWTaQfjDkI7sVEn5zal4pcLhmj8NQh6+F53WPx0v2PkoKDMlt47jb0KKE5YsrKesncKXCgEZKo1o3ggm6l1MhPJZTINcnKcHCAwkygvpoYH7Tc1FcDsw4hgmcjp2ryvdj7kYN/wtR6bq4KCcJRvmmT1p/PQsgzKmnOJ/q6xo2zTPq04hXKyz8J43C42jEk17xnw1v3oh8QuhUIDVqkibREHT7mMPVApxtFbl6UgzBl0VduA9RDnyAzeI7O2JT5pA9wq0UvW2yaqEix2NGu483S49hXC6+se0ZLLNN9qSM3RQWpzxXkbS/2LRtc1XG9dfcRpeTAjcl0T6CmmmNyGGmsZuA0ZSmQZpHCtpcQ/BV90xJ+Uc4wpzzbJUvLkzCeOmb/cWQdzREDSq8NshJ8e8dGcf32BLwqSvdJUWNXMns5Ux3Hc+ZyKeJT/oDQ2jve7f4VFwWcS8cDCvSy/KhLNMnXPEL4tv4r9xbh+DxiZ4c2ow7adMYdt5PNJpQd/2ik9HCf3S/TM4QwMFXMQ8FDmz9Bh+bB5UkGeB3N0z43eESDfCrqfVnsf9V6438lKJCvAD/gYhN+QaUyzsc1yh2I//nxR4gxILigKnI8iU4h4hx0qDi0Om76sfxHNpllY7bSs3VSmc7rdciib7q50SWMPO7r5uNa4k1EC3cUWebtZd8vAmt0qDwk4Qe0KdkZlZt+vjpPD0NadTOb0Ubx93JdJ8BXSKZFKPxZHhY8KGSOlFoYdE1mchAJvOcVFRhDa7QyZt57+3xkBwFFQJfMgIrgt9XfiD9MqavwEf7l6vk4fqNI6cxqj3GDWh+FbJjxQb8LfAiND7K++mflVzUBUmaw9a0ujLpyNB0K26+mnfKUUO2J4sDn8aOrr4EvbQlq/VDqrJB4HN8ubJJtCPkNNVXzDcuup3XA3fNtsme1cfwvjIJY972jcuKFeDqYCFzrY4W7xr4dbGqM5SVy3LC2b6I1DglkUQD/C00pwd4uxjZ1azVL00zUmcfnoMG4vKB4ln81O8cfz5jO+Al62UWqqFcjLYySu2826bfuRmrLKddKef6Eo/Fw6JvuuxMHBMWqUOWtS1N6TboYeclfKcir6KfBK37mVHJSle+yNLXJla43hz3Abe/vXjT/X6JjDlGL7OG9od5tnhKqZd/8s8iEpqlV8MKf5Zm1kRz0N85CLZmIQI3FV+sK35Cku3f32e135pn4pBLaGVxl2/tdWbBA8ANrTf7gB2O16U9wopvW86+Tw31lVwuxihD7Txy3vBpsuRQHqoFKU+PxO4yjjLG+8I0u3VUkID/stj/rwAAAP//Obvb6O8aAAA=",
	"bob":   "CAMSEB5ZHHcuDf+zq9ac0Vm+ujgagARv1TdUlFIF26KaLYi8LNLe8Z2MDe6EBiK1URXDyShqwV3QIBGibBdg6+kP/OMC1AxebnqXMQWwAnHoKgwJ1vXt58Ak4d3EWcHrYlK3KsGKQ+catN2WuWataXwzZoJKBlD8KwST3FFvY+0mgCEg2FK2fkX1xDe4yJrG3UEQVA+EHcfJrFWwujuR+WlT1uXedcpOhv23nHTlobxwr+y4yiJBlefXfROZQ7FA7iBpHuaDKmZAXv2vHnGF0Pk9L8dLfSOB34kMd2MJEp6I5M0oHBr0EL1LOZ6hP2HwPdvXsxwcFi/6VIMXyz9aJ1P25mKLNRX41ebA89YAc83v/V7ubbPbdlXkj4OZRudmtpA0dK9VzErdX6H6N02c/1m9Xl3Rcr4y1PdWKL2NxbK1K8MtkILRasHHYQVvcr+Bj+lrNvydOBeeVkjK025vAnGz2308rZ9ICtdEmNmqFBMYyYmO+GsYdq4x1Ak8nKybqVbS7NZsQAq+f0g5thSI1vRSI3nopGX9wmlLO9taybZGK6CxID57KB+mJZYCFkkN6gok614cUzEW2/ISycqk+YCJXry/4eqpq+bIHX8O7Bpk93WDcmvhZbJYtpjJoHHXbWS4AqsQnyE6yMcRMO0s1OuDyZpySLyJ3oW5cAVT0oDcQfwHSpdZElzoJHjS7dZXujdIN6h1QSIKU0hBMzg0LVJTQSoDUlNBMkIKE2FwaS5ib2IudmFzcGJvdC5uZXQaD0NpcGhlclRyYWNlIEluYzIKTWVubG8gUGFyazoKQ2FsaWZvcm5pYUoCVVM6RQoWQ2lwaGVyVHJhY2UgSXNzdWluZyBDQRoPQ2lwaGVyVHJhY2UgSW5jMgpNZW5sbyBQYXJrOgpDYWxpZm9ybmlhSgJVU0IUMjAyMi0wMi0yOFQxNzo1MzozNVpKFDIwMjMtMDMtMjhUMTc6NTM6MzRaWrwTLS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUhBakNDQk9xZ0F3SUJBZ0lRSGxrY2R5NE4vN09yMXB6UldiNjZPREFOQmdrcWhraUc5dzBCQVF3RkFEQnkKTVFzd0NRWURWUVFHRXdKVlV6RVRNQkVHQTFVRUNCTUtRMkZzYVdadmNtNXBZVEVUTUJFR0ExVUVCeE1LVFdWdQpiRzhnVUdGeWF6RVlNQllHQTFVRUNoTVBRMmx3YUdWeVZISmhZMlVnU1c1ak1SOHdIUVlEVlFRREV4WkRhWEJvClpYSlVjbUZqWlNCSmMzTjFhVzVuSUVOQk1CNFhEVEl5TURJeU9ERTNOVE16TlZvWERUSXpNRE15T0RFM05UTXoKTkZvd2J6RUxNQWtHQTFVRUJoTUNWVk14RXpBUkJnTlZCQWdUQ2tOaGJHbG1iM0p1YVdFeEV6QVJCZ05WQkFjVApDazFsYm14dklGQmhjbXN4R0RBV0JnTlZCQW9URDBOcGNHaGxjbFJ5WVdObElFbHVZekVjTUJvR0ExVUVBeE1UCllYQnBMbUp2WWk1MllYTndZbTkwTG01bGREQ0NBaUl3RFFZSktvWklodmNOQVFFQkJRQURnZ0lQQURDQ0Fnb0MKZ2dJQkFOeHBqVGRoMisweXlMakRFYUxlRUZEYXJaUmg0TExPNThNbHFseFBVTCtwcTdrano1QVpSelRjb1NlZgpxQ0V1aHpDWi9UdlZOcUV3ZWt1Tk45T01jc3NmSk5lYW1jN3RYSGltbFptWUVwRVZ3eW10NjREQ2orUFlIWDFMCmRyRldEZ09Kc1BGMDI4ZFFuVWljMXFWVy9DOWNLSnBSa25lZGNJbUZZanJDNWNnQkZZZnQvRnZ2bVVGL3Q0cEcKTWJHYWoyZklKWUVYdGt6b1p2dElvNjg0Qzd5L2t2NzJVdmpiU3RpcUZzVkIvaUhrSVd6ZzJwdTJiQ1VFR0RaagpoNTV6aDhITXloMEwzeEZ2RGxuUXl1eWdMYUlNRU1EVHlhTksrRlpZVHBNcWNXVjdVR0o1ZGFiZ2NiLzIvRUhPClZoKzJ2dkNpc2QzcTV5YmlyQzZlUVJ5UXFFYnFkNzd3NHRaRFVyOThvUytEemdHZ2VVdWY3OVpJZ1dYOXg1S0UKRkFaOWpsdzRtRnVPQVE5dTYzMU5iT0llYVFZT3RLZ05RNGg1OVhHQzBjRHFxWFc1NlFkeFAweVFDb3hNODYwawplVjVNNkdoV3E2QUJudVdJN1dieVBTaHhvaWhyUzd1cHVtZE11RHBTRHQwYWxsR0ZmbTFLeXNZUkZiL1N6NXFCCjRYMkUrSk54T0daUUxsT2FpQm1icXdPeE9wY2lndEVjVlc1QkVSVDJ6aVMrdGttUEVqRjFxeHMySFVCa3lHL04KYWhvNjBFZVFzYWgvZWNlVzJuMVllWlFPYlNpcWU2dkd0TXJPeFY3ZmNGc24vckoxdVBzSlpnL0l4aWxOSm5jbQpnUWk1S29IK080NVJYUU5jM0lUejdDVmdmd0VyaE1kUW9PZy91RmJ0dytkaHlIZlhBZ01CQUFHamdnR1ZNSUlCCmtUQWZCZ05WSFNNRUdEQVdnQlJidTRqTzJSZzV5NHRyZ3ZFQWIxcGtKdVA5ZGpBT0JnTlZIUThCQWY4RUJBTUMKQmVBd0RBWURWUjBUQVFIL0JBSXdBREFnQmdOVkhTVUJBZjhFRmpBVUJnZ3JCZ0VGQlFjREFnWUlLd1lCQlFVSApBd0V3VlFZRFZSMGZCRTR3VERCS29FaWdSb1pFYUhSMGNEb3ZMMk5wY0dobGNuUnlZV05sTG1OeWJDNXBiM1F1CmMyVmpkR2xuYnk1amIyMHZRMmx3YUdWeVZISmhZMlZKYm5SbGNtMWxaR2xoZEdWRFFTNWpjbXd3Z1pjR0NDc0cKQVFVRkJ3RUJCSUdLTUlHSE1GQUdDQ3NHQVFVRkJ6QUNoa1JvZEhSd09pOHZZMmx3YUdWeWRISmhZMlV1WTNKMApMbWx2ZEM1elpXTjBhV2R2TG1OdmJTOURhWEJvWlhKVWNtRmpaVWx1ZEdWeWJXVmthV0YwWlVOQkxtTnlkREF6CkJnZ3JCZ0VGQlFjd0FZWW5hSFIwY0RvdkwyTnBjR2hsY25SeVlXTmxMbTlqYzNBdWFXOTBMbk5sWTNScFoyOHUKWTI5dE1CNEdBMVVkRVFRWE1CV0NFMkZ3YVM1aWIySXVkbUZ6Y0dKdmRDNXVaWFF3SFFZRFZSME9CQllFRk83ZQo3UExTZUdPUXI2aVhvN3RWN2xJTFR3YUxNQTBHQ1NxR1NJYjNEUUVCREFVQUE0SUNBUUJ2MVRkVWxGSUYyNkthCkxZaThMTkxlOFoyTURlNkVCaUsxVVJYRHlTaHF3VjNRSUJHaWJCZGc2K2tQL09NQzFBeGVibnFYTVFXd0FuSG8KS2d3SjF2WHQ1OEFrNGQzRVdjSHJZbEszS3NHS1ErY2F0TjJXdVdhdGFYd3pab0pLQmxEOEt3U1QzRkZ2WSswbQpnQ0VnMkZLMmZrWDF4RGU0eUpyRzNVRVFWQStFSGNmSnJGV3d1anVSK1dsVDF1WGVkY3BPaHYyM25IVGxvYnh3CnIreTR5aUpCbGVmWGZST1pRN0ZBN2lCcEh1YURLbVpBWHYydkhuR0YwUGs5TDhkTGZTT0IzNGtNZDJNSkVwNkkKNU0wb0hCcjBFTDFMT1o2aFAySHdQZHZYc3h3Y0ZpLzZWSU1YeXo5YUoxUDI1bUtMTlJYNDFlYkE4OVlBYzgzdgovVjd1YmJQYmRsWGtqNE9aUnVkbXRwQTBkSzlWekVyZFg2SDZOMDJjLzFtOVhsM1JjcjR5MVBkV0tMMk54YksxCks4TXRrSUxSYXNISFlRVnZjcitCaitsck52eWRPQmVlVmtqSzAyNXZBbkd6MjMwOHJaOUlDdGRFbU5tcUZCTVkKeVltTytHc1lkcTR4MUFrOG5LeWJxVmJTN05ac1FBcStmMGc1dGhTSTF2UlNJM25vcEdYOXdtbExPOXRheWJaRwpLNkN4SUQ1N0tCK21KWllDRmtrTjZnb2s2MTRjVXpFVzIvSVN5Y3FrK1lDSlhyeS80ZXFwcStiSUhYOE83QnBrCjkzV0RjbXZoWmJKWXRwakpvSEhYYldTNEFxc1FueUU2eU1jUk1PMHMxT3VEeVpweVNMeUozb1c1Y0FWVDBvRGMKUWZ3SFNwZFpFbHpvSkhqUzdkWlh1amRJTjZoMVFRPT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQpisyIfiwgAAAAAAAD/1NjHzqxasiDgOU/R81Qr8WZwB3jvPTO8TxJvnr71733r1Dl1napLaqlzuAJWEEgR60v+98+P4UXZ+F8s73iyILO0x/9aBXRZluiOZRlzrulTZuhatqWhz4sbNd6EuUDfxwkzHDc52mDqfm76VqROkKHtU6A55gZ0ez1ZO+YC2xb5Uwn8h/d0hhdpyOdZRldtWFjTMDnyEfvG3t9jzKWrXhjsQCaStS8Kd/rwsc7Ev29sdMuGhzMVgzuQlCaG/doNsU53yFP6nYzjr4RLI2YCkkjx81HoEpdRcsSA0hD7yLzB6AwacZ5865x8mxyPGJ7+GMH0s/bonP7HGmAI05k9vKbT/e9Ha3Q2CPSLf2iHqY2AoWuP7Y0mE4cxQ5Q9Dfk/xXIPYHtoyMbrkAWmycf1Ejk6/B2cPA40vrnYDPng3HFoDDI/7PHD5zoz/UpGX7oHxBHz1UbliFsMjiPjjEcK1EZsKDiW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",
}

var certreqs = map[string]*models.CertificateRequest{
	"alice": {
		Id:           "e2d7ef62-28e2-4fb9-9fd6-4fb107d942a6",
		Vasp:         "7a96ca2c-2818-4106-932e-1bcfd743b04c",
		CommonName:   "api.alice.vaspbot.net",
		Status:       models.CertificateRequestState_COMPLETED,
		AuthorityId:  23,
		BatchId:      309867,
		BatchName:    "trisatest.net-certreq-e2d7ef62-28e2-4fb9-9fd6-4fb107d942a6",
		BatchStatus:  "READY_FOR_DOWNLOAD",
		OrderNumber:  309867,
		CreationDate: "2022-02-28T11:39:38.000+0000",
		Profile:      "CipherTrace EE",
		RejectReason: "",
		Params:       map[string]string{},
		Created:      time.Now().Format(time.RFC3339Nano),
	},
	"bob": {
		Id:           "1177a95b-7e24-411a-a0a8-3210e4b93b2b",
		Vasp:         "9e069e01-8515-4d57-b9a5-e249f7ab4fca",
		CommonName:   "api.bob.vaspbot.net",
		Status:       models.CertificateRequestState_COMPLETED,
		AuthorityId:  23,
		BatchId:      309870,
		BatchName:    "trisatest.net-certreq-1177a95b-7e24-411a-a0a8-3210e4b93b2b",
		BatchStatus:  "READY_FOR_DOWNLOAD",
		OrderNumber:  309870,
		CreationDate: "2022-02-28T11:53:42.000+0000",
		Profile:      "CipherTrace EE",
		RejectReason: "",
		Params:       map[string]string{},
		Created:      time.Now().Format(time.RFC3339Nano),
	},
}

func reissueNMSCerts() (err error) {
	var vasp *pb.VASP
	vaspID := "00634f29-e22e-48f5-be2a-74feeee33464"
	commonName := "eczesgsg.trisa.test-travelrule.sygna.io"
	endpoint := "eczesgsg.trisa.test-travelrule.sygna.io:443"

	if vasp, err = db.RetrieveVASP(vaspID); err != nil {
		return fmt.Errorf("could not retrieve vasp record: %v", err)
	}

	// Reset the Travel Rule information
	vasp.CommonName = commonName
	vasp.TrisaEndpoint = endpoint
	vasp.IdentityCertificate = nil

	// Cannot validate
	// if err = vasp.Validate(false); err != nil {
	// 	return fmt.Errorf("vasp is not valid: %v", err)
	// }

	if err = models.UpdateVerificationStatus(vasp, pb.VerificationState_REVIEWED, "manually reissuing testnet certificates", "benjamin@rotational.io"); err != nil {
		return fmt.Errorf("could not update VASP record: %v", err)
	}

	// Create a new certificate request for the reissuance
	password := secrets.CreateToken(16)
	fmt.Printf("password is %q\n", password)

	var certreq *models.CertificateRequest
	if certreq, err = models.NewCertificateRequest(vasp); err != nil {
		return err
	}

	if err = models.UpdateCertificateRequestStatus(certreq, models.CertificateRequestState_READY_TO_SUBMIT, "reissue certificates", "benjamin@rotational.io"); err != nil {
		return fmt.Errorf("could not update certreq: %v", err)
	}

	// Connect to secret manager
	var sm *secrets.SecretManager
	if sm, err = secrets.New(conf.Secrets); err != nil {
		return err
	}

	// Make a new secret of type password
	secretType := "password"
	if err = sm.With(certreq.Id).CreateSecret(context.TODO(), secretType); err != nil {
		return err
	}
	if err = sm.With(certreq.Id).AddSecretVersion(context.TODO(), secretType, []byte(password)); err != nil {
		return err
	}

	// Update the certreq
	if err = db.UpdateCertReq(certreq); err != nil {
		return err
	}

	// Append the certificate request to the VASP
	if err = models.AppendCertReqID(vasp, certreq.Id); err != nil {
		return err
	}

	// Update the vasp
	if err = db.UpdateVASP(vasp); err != nil {
		return err
	}

	return nil
}

var vasptest1cert = "CAMSEHyhWDZSfNUfjnjx5FNXteUagAQLcta5zdtY87BsEPwVcyGgUSCGpXio2J17RmDCBQYiXhNnzYVnRzzp/CUUip463dguDy/Z+pv6F+cqoPLUez7sKKHxvtnv7QkFGFdWtNwUDZqhWKdZSXrpocIo03fmLHJYRjXs2kGr21eK2bwxPWpSikv1+3iu+VyMlv/ytIgIcz+hmEYWbeRLrSFmaNUP0VYfIRMipGY/0lIuyY8WNoNCKvEVudRQr5EHuc0ymoUl13tZP1S4uCuLo/+flpndTyI4z9dH3PK763TDHXW9HtsWCjeyHrE+96b8AqGYON1mnJoWbZgUcP4MeK2RmpC8MfNq5NuQa5UY6hZ4MD9ZAEEjNgFYWdW7gvWf5+E5KWmw+KRu3JEAH47VPTH05N+Hizf7+KxFSnbMby4ndoNoXc7tv+MLN0CnVFa3JOlkTpeFvofhyGbNV7Cs85Z3Yy09/Hkd+v54XOxxmVsrMfRu6K0JDHNULtFqQG8NI3Dg2Hd0nhfNRd0yhX1lTBNxTs/2tEpl+oh83ts88z0kzJmqtWAeY8zPdaxZPEpI8fewEZrapUY/79gqNS/2IqSAB9Ssll+nMjAMctm7k4GJEtXOZBEFf+7CckRj/+ugVWaZUkPMn1DWCZmCtGJiz4u2ietH5P7eoOLTKM0Omwl5jkSeEiPXhKF7FQ4NVgDvBY5keeVxtiIKU0hBMzg0LVJTQSoDUlNBMlAKIWdhdGV0dzA1LnRlc3QtdHJhdmVscnVsZS5zeWduYS5pbxoPQ2lwaGVyVHJhY2UgSW5jMgpNZW5sbyBQYXJrOgpDYWxpZm9ybmlhSgJVUzpFChZDaXBoZXJUcmFjZSBJc3N1aW5nIENBGg9DaXBoZXJUcmFjZSBJbmMyCk1lbmxvIFBhcms6CkNhbGlmb3JuaWFKAlVTQhQyMDIyLTAzLTMwVDAyOjQ3OjAwWkoUMjAyMy0wNC0zMFQwMjo0Njo1OVpa7xotLS0tLUJFR0lOIENFUlRJRklDQVRFLS0tLS0KTUlJSnZUQ0NCNldnQXdJQkFnSVFmS0ZZTmxKODFSK09lUEhrVTFlMTVUQU5CZ2txaGtpRzl3MEJBUXdGQURCeQpNUXN3Q1FZRFZRUUdFd0pWVXpFVE1CRUdBMVVFQ0JNS1EyRnNhV1p2Y201cFlURVRNQkVHQTFVRUJ4TUtUV1Z1CmJHOGdVR0Z5YXpFWU1CWUdBMVVFQ2hNUFEybHdhR1Z5VkhKaFkyVWdTVzVqTVI4d0hRWURWUVFERXhaRGFYQm8KWlhKVWNtRmpaU0JKYzNOMWFXNW5JRU5CTUI0WERUSXlNRE16TURBeU5EY3dNRm9YRFRJek1EUXpNREF5TkRZMQpPVm93ZlRFTE1Ba0dBMVVFQmhNQ1ZWTXhFekFSQmdOVkJBZ1RDa05oYkdsbWIzSnVhV0V4RXpBUkJnTlZCQWNUCkNrMWxibXh2SUZCaGNtc3hHREFXQmdOVkJBb1REME5wY0dobGNsUnlZV05sSUVsdVl6RXFNQ2dHQTFVRUF4TWgKWjJGMFpYUjNNRFV1ZEdWemRDMTBjbUYyWld4eWRXeGxMbk41WjI1aExtbHZNSUlDSWpBTkJna3Foa2lHOXcwQgpBUUVGQUFPQ0FnOEFNSUlDQ2dLQ0FnRUF3M0RmSTh2ekxscE82bWZqVDd2SU1zc1ZqVUNxU0pVS1VLdXFBWHJsCmFOdnNtdExZVmJoTzJrT01ML09rU080TEV4dDhmMzlTUEdtVXVzUmdVMVJWbHlOcExDSXdCb0tpd1drb3JuOHgKQ1VXb0w3QytGdmtRNnFYbHdYM1NON3NmVVRuY1ZhODBrR2EreTdLQk9KZm1KV29VcDV0N1VQell3TkUvNFEvMgpYekFOZEpiSlRMb3NidGd2bk5sZURQa3NRMkRlNzhzVkdxZHdmRjYxSzFNcllPL1ZlTVBBNzRJcHhNMWNUbDRkCkdxVkpvSkVJdGlHbXZHMG5iUC9vZ29PcnF1VjIrbWZ0blhrRE1tdzhmVGIxdFB4YWJrWkZ0VW9ndkxnQ0NGVzAKUVJOUWRDNXBoSFV4dnU4NXlRQVQxYWQzSWFXNDNqM2xyZDlTU0o3d25KeFpoOTlVbHFaUk12WHlNcWdyUEN5OApEOVlmdms3TkNna3lXTW9ZNjkxbUliUTIrSXA2SXZpcXo4L3J2eWV2MmE3SmtLeG5VdzFBTFFIYVlZTHl1bGlqCjlmdnY5UmwyWjdoNzJkdzhFR05RRnJTNldiajd4aEJtaS9IVHZZSzJOOFhqOGREWnJHWjBIQTBkOXkramUzS3kKWkVnYWVsMnJNT1drRElMU0J4RWYydmkzc1A3S2JENEFGNkxiWnIwanVXK0RFeHBTdWNCTUFZSVR1cUxaUjB2MwpnR0JSVS9SY250SHdJMmhNZXAzbVlyVVZoMzhVL0I2MFp2RUxCdk9xdWNXbDBpa29uV3R3NEl1L3lmclJCY1ZLCmVhb2NtVnVzVktiOHlQRE80TWRGQ2xzU1I0SzVYemFINitLUGRDS2YyNjdxSTBId3VGZFFJUzE2ZVMrRE9OSy8KOXprQ0F3RUFBYU9DQkVJd2dnUStNQjhHQTFVZEl3UVlNQmFBRkZ1N2lNN1pHRG5MaTJ1QzhRQnZXbVFtNC8xMgpNQTRHQTFVZER3RUIvd1FFQXdJRjREQU1CZ05WSFJNQkFmOEVBakFBTUNBR0ExVWRKUUVCL3dRV01CUUdDQ3NHCkFRVUZCd01DQmdnckJnRUZCUWNEQVRCVkJnTlZIUjhFVGpCTU1FcWdTS0JHaGtSb2RIUndPaTh2WTJsd2FHVnkKZEhKaFkyVXVZM0pzTG1sdmRDNXpaV04wYVdkdkxtTnZiUzlEYVhCb1pYSlVjbUZqWlVsdWRHVnliV1ZrYVdGMApaVU5CTG1OeWJEQ0Jsd1lJS3dZQkJRVUhBUUVFZ1lvd2dZY3dVQVlJS3dZQkJRVUhNQUtHUkdoMGRIQTZMeTlqCmFYQm9aWEowY21GalpTNWpjblF1YVc5MExuTmxZM1JwWjI4dVkyOXRMME5wY0dobGNsUnlZV05sU1c1MFpYSnQKWldScFlYUmxRMEV1WTNKME1ETUdDQ3NHQVFVRkJ6QUJoaWRvZEhSd09pOHZZMmx3YUdWeWRISmhZMlV1YjJOegpjQzVwYjNRdWMyVmpkR2xuYnk1amIyMHdnZ0xKQmdOVkhSRUVnZ0xBTUlJQ3ZJSWhaMkYwWlhSM01EVXVkR1Z6CmRDMTBjbUYyWld4eWRXeGxMbk41WjI1aExtbHZnaUZuWVdKdmFuQjBlUzUwWlhOMExYUnlZWFpsYkhKMWJHVXUKYzNsbmJtRXVhVytDSVhSbGMzUjBkM1JsTG5SbGMzUXRkSEpoZG1Wc2NuVnNaUzV6ZVdkdVlTNXBiNEloWW1sMApZbXR5YzJVdWRHVnpkQzEwY21GMlpXeHlkV3hsTG5ONVoyNWhMbWx2Z2lGa2IzSmhkSGQwY0M1MFpYTjBMWFJ5CllYWmxiSEoxYkdVdWMzbG5ibUV1YVcrQ0lXcHRZMmgwZHpBeUxuUmxjM1F0ZEhKaGRtVnNjblZzWlM1emVXZHUKWVM1cGI0SWhaMkZpYjNSM2RIQXVkR1Z6ZEMxMGNtRjJaV3h5ZFd4bExuTjVaMjVoTG1sdmdpRm5ZV0p2WVhWdApkUzUwWlhOMExYUnlZWFpsYkhKMWJHVXVjM2xuYm1FdWFXK0NJWFpoYzNCMGR6azVMblJsYzNRdGRISmhkbVZzCmNuVnNaUzV6ZVdkdVlTNXBiNEloWjJGMFpYUjNNRFl1ZEdWemRDMTBjbUYyWld4eWRXeGxMbk41WjI1aExtbHYKZ2lGemVXZHVZV1p4Ymk1MFpYTjBMWFJ5WVhabGJISjFiR1V1YzNsbmJtRXVhVytDSVhSbGMzUjBkSFIwTG5SbApjM1F0ZEhKaGRtVnNjblZzWlM1emVXZHVZUzVwYjRJaGMzbG5iblIzT0RFdWRHVnpkQzEwY21GMlpXeHlkV3hsCkxuTjVaMjVoTG1sdmdpRm5ZV0p2WTJGMGJ5NTBaWE4wTFhSeVlYWmxiSEoxYkdVdWMzbG5ibUV1YVcrQ0lYTjUKWjI1aFpuaHRMblJsYzNRdGRISmhkbVZzY25Wc1pTNXplV2R1WVM1cGI0SWhjM2xuYm1GbU4zTXVkR1Z6ZEMxMApjbUYyWld4eWRXeGxMbk41WjI1aExtbHZnaUZ6ZVdkdVoySnNiaTUwWlhOMExYUnlZWFpsYkhKMWJHVXVjM2xuCmJtRXVhVytDSVhONVoyNWhabTlzTG5SbGMzUXRkSEpoZG1Wc2NuVnNaUzV6ZVdkdVlTNXBiNEloWjJGMFpYUjMKTVRFdWRHVnpkQzEwY21GMlpXeHlkV3hsTG5ONVoyNWhMbWx2Z2lGemVXZHVZV1p1T0M1MFpYTjBMWFJ5WVhabApiSEoxYkdVdWMzbG5ibUV1YVc4d0hRWURWUjBPQkJZRUZERDdWd2U5a1RITjVmTWVWVmRURk5lSzk0UzdNQTBHCkNTcUdTSWIzRFFFQkRBVUFBNElDQVFBTGN0YTV6ZHRZODdCc0VQd1ZjeUdnVVNDR3BYaW8ySjE3Um1EQ0JRWWkKWGhObnpZVm5SenpwL0NVVWlwNDYzZGd1RHkvWitwdjZGK2Nxb1BMVWV6N3NLS0h4dnRudjdRa0ZHRmRXdE53VQpEWnFoV0tkWlNYcnBvY0lvMDNmbUxISllSalhzMmtHcjIxZUsyYnd4UFdwU2lrdjErM2l1K1Z5TWx2L3l0SWdJCmN6K2htRVlXYmVSTHJTRm1hTlVQMFZZZklSTWlwR1kvMGxJdXlZOFdOb05DS3ZFVnVkUlFyNUVIdWMweW1vVWwKMTN0WlAxUzR1Q3VMby8rZmxwbmRUeUk0ejlkSDNQSzc2M1RESFhXOUh0c1dDamV5SHJFKzk2YjhBcUdZT04xbQpuSm9XYlpnVWNQNE1lSzJSbXBDOE1mTnE1TnVRYTVVWTZoWjRNRDlaQUVFak5nRllXZFc3Z3ZXZjUrRTVLV213CitLUnUzSkVBSDQ3VlBUSDA1TitIaXpmNytLeEZTbmJNYnk0bmRvTm9YYzd0ditNTE4wQ25WRmEzSk9sa1RwZUYKdm9maHlHYk5WN0NzODVaM1l5MDkvSGtkK3Y1NFhPeHhtVnNyTWZSdTZLMEpESE5VTHRGcVFHOE5JM0RnMkhkMApuaGZOUmQweWhYMWxUQk54VHMvMnRFcGwrb2g4M3RzODh6MGt6Sm1xdFdBZVk4elBkYXhaUEVwSThmZXdFWnJhCnBVWS83OWdxTlMvMklxU0FCOVNzbGwrbk1qQU1jdG03azRHSkV0WE9aQkVGZis3Q2NrUmovK3VnVldhWlVrUE0KbjFEV0NabUN0R0ppejR1MmlldEg1UDdlb09MVEtNME9td2w1amtTZUVpUFhoS0Y3RlE0TlZnRHZCWTVrZWVWeAp0Zz09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0KYu8kH4sIAAAAAAAA/9SYx470xrLn93yK2RcGRW8Wd0HvWfRuR08WXdGbpx90f9KRviNdSTMHGOD2qpHMYP4jojIYv/jfX38ML8rG/2J525UFmaVd/nsV0GVZ2V2WZfCgog+ZoSvZKlUhMjqFhOzHqzCl1oMKCHNpg6naqW4bkTpAhrYOgeaYC9Ct5WCtiPMtS+QPxfdu3tUZXqQhj2cZXbVgYUmCeM967BO5vz1jTl11A38DUpGsPFG4kpuPdCb6YVjrpgV3RyL6ly8pdQR7lRNgb90mD+nHYRx/xlwSMiMQh4qX9cI7dhglQwwoCbBB5g1GZ9CQc+VL5/Rb5+jL4LJDF8avtVvnrF/WIgh4+eNRurym0+0PabXO+r5+8jdtM5XhM3Tlsq1Rp2LXp4iyJQH/u2eZ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"

var vasptest2cert = "CAMSEFtrENn1vXbwd6Q6mxydDbIagAQUhrKURuCAt8F2ceYJhzsRr9AzXxusTSJUJVHo5lX6dpAt19lSoNpR4PXv3YOjr0gAIJNyR4IJ87s04fJrsG1VSzcfzvGW8BSsZ1KIGENmsX0NwYYN43krYWZdVi50V5bNK6qF5N43trnnEAhrX94xCcVkdhL0Sus8EV/osTsEksvZ0GQ+0OCJ6LCweL8bnF82zF+K83cvpWgEOf4EF4gQFSfL3qapcW6UnO9EmoKP2xhA6aLM0nC8ToPOjjjqc/SB/8G5kog6/cEFJPte0H7b8F1R/6tKqHjodq4eQBEexWAEjz8wqXbFAlk8QZouYAolFZ5mQEm3C3IiYoUVN0wElnpc11t4amMgVxYklbhQJL9EY/SBlRpebfxNEgqVi7wmEITxQkVO/S1lDTDkVFAgAWMqdsiJotalf6Pw9unFlHYvic+yhVhtoGWsKSJS3aQu9T6TdizUkizNDW5hMx5MNy9+ZRk3gKDyUBuFTVqL3FaYzht0bTmgfw9oqHnbt6Z6eQSa3YnnrjWSKzTX7k02VKyPizeDc6kFYMgKWYk22rjDGfW3Uhtwh7ArIFNKraywczZCQd+Ppe+2FC3Lmq0A48daEMWj5aaLIrgciC0widRrUhw3X1YbP38IFjeQQ/+o+fnIhguroGV4+gmHi4wsCWz/CU8BY2AIj0p7GhxaOiIKU0hBMzg0LVJTQSoDUlNBMk8KIGh1Yi10cmlzYS5icmFobWEtZGV2LWpwLnN5Z25hLmlvGg9DaXBoZXJUcmFjZSBJbmMyCk1lbmxvIFBhcms6CkNhbGlmb3JuaWFKAlVTOkUKFkNpcGhlclRyYWNlIElzc3VpbmcgQ0EaD0NpcGhlclRyYWNlIEluYzIKTWVubG8gUGFyazoKQ2FsaWZvcm5pYUoCVVNCFDIwMjItMDMtMzBUMDI6NDg6NDNaShQyMDIzLTA0LTMwVDAyOjQ4OjQyWlrcEy0tLS0tQkVHSU4gQ0VSVElGSUNBVEUtLS0tLQpNSUlISERDQ0JRU2dBd0lCQWdJUVcyc1EyZlc5ZHZCM3BEcWJISjBOc2pBTkJna3Foa2lHOXcwQkFRd0ZBREJ5Ck1Rc3dDUVlEVlFRR0V3SlZVekVUTUJFR0ExVUVDQk1LUTJGc2FXWnZjbTVwWVRFVE1CRUdBMVVFQnhNS1RXVnUKYkc4Z1VHRnlhekVZTUJZR0ExVUVDaE1QUTJsd2FHVnlWSEpoWTJVZ1NXNWpNUjh3SFFZRFZRUURFeFpEYVhCbwpaWEpVY21GalpTQkpjM04xYVc1bklFTkJNQjRYRFRJeU1ETXpNREF5TkRnME0xb1hEVEl6TURRek1EQXlORGcwCk1sb3dmREVMTUFrR0ExVUVCaE1DVlZNeEV6QVJCZ05WQkFnVENrTmhiR2xtYjNKdWFXRXhFekFSQmdOVkJBY1QKQ2sxbGJteHZJRkJoY21zeEdEQVdCZ05WQkFvVEQwTnBjR2hsY2xSeVlXTmxJRWx1WXpFcE1DY0dBMVVFQXhNZwphSFZpTFhSeWFYTmhMbUp5WVdodFlTMWtaWFl0YW5BdWMzbG5ibUV1YVc4d2dnSWlNQTBHQ1NxR1NJYjNEUUVCCkFRVUFBNElDRHdBd2dnSUtBb0lDQVFDbXR2Y1NncFZQeC9yc1dXUkJ3NXN6NlY2ZWp0aDJXY0tJSXlUWnhBQnAKVWJsZUVXNVZ5OHVIejc1dElUQkRLNHpNbys4YjVMQ2xMWTh6RDlUWHhEeUdpK0VuK2NCOWdjeUhsQm9vemlkUQpYd3QzWWxGWWsydm51eDFYRUZ2Q0JFRDZEUWx5SklQQ0ltblEyK3FrNFZLQ21ZdTYra2hDSGxRUzR0emN4Q2hHCk5YRC8xNkUwbXIzeDVwVXp4azR0bDZ6bW1kT2cwSjVDNmRYNUdPWDYvNVZTMCtOd3ZmS3ZGQWdXVjBkVW9DdFQKWnJHTlhESk9NZ3B6UC96elRrb2pEYVhWTXZLa2Y5KzBWdml4RHl6WGhmSHVOYnl3dElOOVhBb29qeU9oWXdyNApBait2MmVkTDFtVUVILzAvQUU5bkFXSjhQM1YyTnN1TEpGeFNRT1FlWFhoTnl2ZHJwalNCVWNQQVVZb054am5FCkw2WE1HMXF4ZVdReUt4SVljeEFiRG91N3dYYzVnamxLQkpsaUtHWGdId0t3a3pIWkROZ0luUzBtaDRsZmJXR3YKNDk4RGJxZmxQMUhkWVI0MEhoQWpYbGdPcTVOOGRqSjhpaDZ5SzZxZWEvNTZ3M0hvTG5hZUFuSjR2RVRBenVwYgpaTUZXQnU2TlozS20vYTlUOWpNTHhRdXZTd1FpTWVTVzFZK3I5YlFsendVa3Z1QlREOXhKQkRpS0ltQks0V3RlCk0rN0hMQ3p2c2F2ZExCVitaM0RvanA1L1VIN01EbVhxcUVuNTRSc256NkNiSGJyYmpXT1IwT0tUanR1UzI5bEsKcVNFclVBVUZ4RktSNUZhQThuRVplV1Y0dXZNWWR2SWZkV2pRMlN3VlNjMTBnRUlKcUl4Y1VHdzNCeFRnWlNsTgo2UUlEQVFBQm80SUJvakNDQVo0d0h3WURWUjBqQkJnd0ZvQVVXN3VJenRrWU9jdUxhNEx4QUc5YVpDYmovWFl3CkRnWURWUjBQQVFIL0JBUURBZ1hnTUF3R0ExVWRFd0VCL3dRQ01BQXdJQVlEVlIwbEFRSC9CQll3RkFZSUt3WUIKQlFVSEF3SUdDQ3NHQVFVRkJ3TUJNRlVHQTFVZEh3Uk9NRXd3U3FCSW9FYUdSR2gwZEhBNkx5OWphWEJvWlhKMApjbUZqWlM1amNtd3VhVzkwTG5ObFkzUnBaMjh1WTI5dEwwTnBjR2hsY2xSeVlXTmxTVzUwWlhKdFpXUnBZWFJsClEwRXVZM0pzTUlHWEJnZ3JCZ0VGQlFjQkFRU0JpakNCaHpCUUJnZ3JCZ0VGQlFjd0FvWkVhSFIwY0RvdkwyTnAKY0dobGNuUnlZV05sTG1OeWRDNXBiM1F1YzJWamRHbG5ieTVqYjIwdlEybHdhR1Z5VkhKaFkyVkpiblJsY20xbApaR2xoZEdWRFFTNWpjblF3TXdZSUt3WUJCUVVITUFHR0oyaDBkSEE2THk5amFYQm9aWEowY21GalpTNXZZM053CkxtbHZkQzV6WldOMGFXZHZMbU52YlRBckJnTlZIUkVFSkRBaWdpQm9kV0l0ZEhKcGMyRXVZbkpoYUcxaExXUmwKZGkxcWNDNXplV2R1WVM1cGJ6QWRCZ05WSFE0RUZnUVVuQTkrWEl4S3ZPZ21hdVFEUFNpVlpKWnMxWjR3RFFZSgpLb1pJaHZjTkFRRU1CUUFEZ2dJQkFCU0dzcFJHNElDM3dYWng1Z21IT3hHdjBETmZHNnhOSWxRbFVlam1WZnAyCmtDM1gyVktnMmxIZzllL2RnNk92U0FBZ2szSkhnZ256dXpUaDhtdXdiVlZMTngvTzhaYndGS3huVW9nWVEyYXgKZlEzQmhnM2plU3RoWmwxV0xuUlhsczBycW9YazNqZTJ1ZWNRQ0d0ZjNqRUp4V1IyRXZSSzZ6d1JYK2l4T3dTUwp5OW5RWkQ3UTRJbm9zTEI0dnh1Y1h6Yk1YNHJ6ZHkrbGFBUTUvZ1FYaUJBVko4dmVwcWx4YnBTYzcwU2Fnby9iCkdFRHBvc3pTY0x4T2c4Nk9PT3B6OUlIL3dibVNpRHI5d1FVaysxN1FmdHZ3WFZIL3EwcW9lT2gycmg1QUVSN0YKWUFTUFB6Q3Bkc1VDV1R4Qm1pNWdDaVVWbm1aQVNiY0xjaUppaFJVM1RBU1dlbHpYVzNocVl5QlhGaVNWdUZBawp2MFJqOUlHVkdsNXQvRTBTQ3BXTHZDWVFoUEZDUlU3OUxXVU5NT1JVVUNBQll5cDJ5SW1pMXFWL28vRDI2Y1dVCmRpK0p6N0tGV0cyZ1phd3BJbExkcEM3MVBwTjJMTlNTTE0wTmJtRXpIa3czTDM1bEdUZUFvUEpRRzRWTldvdmMKVnBqT0czUnRPYUIvRDJpb2VkdTNwbnA1QkpyZGllZXVOWklyTk5mdVRUWlVySStMTjROenFRVmd5QXBaaVRiYQp1TU1aOWJkU0czQ0hzQ3NnVTBxdHJMQnpOa0pCMzQrbDc3WVVMY3VhclFEangxb1F4YVBscG9zaXVCeUlMVENKCjFHdFNIRGRmVmhzL2Z3Z1dONUJELzZqNStjaUdDNnVnWlhqNkNZZUxqQ3dKYlA4SlR3RmpZQWlQU25zYUhGbzYKLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQpiliMfiwgAAAAAAAD/1JhH7/PKkt73/BTeC4aYRS5m0cyZYg47JjGIOZOf3vi/7w3n3GP7wjOAgdGyutmlp4F+6lf1P39+DC/Kxv9geduVBZkFLv8rCumyLEkcyzKWU4JDZkApWwG6WOgnoPOdwUZuSiUFNpYGGEz5napvLdIHzADrEADHXJBuLQdrRZxvWSJ/KL53867O8CJAPJ5ldNVChSUJ4j3riDFy/7nGnLrqBv4GpSJVeqJwJTcf6Uz0+8NKf1toeySif/mSUkWoVzoB0eg2dUi/k3H8GXNJyAxQHCpe1glN7DBKhhlIEhC9zBuMzuAh58qXzum3zoHL4EpYR4af2K1z1j9ikN4Ox4fjNR18f/+1Smd9Xz/5G9hMafgMKF32a1Sp2HYppmxJwP9hLXMh9ou0aXfussBUWbecIgeC34uD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"

func reissueSygnaCerts() (err error) {
	// Retrieve Sygna VASPs to edit
	var vasptest1, vasptest2 *pb.VASP
	vasptest1ID := "79246c65-0175-43ae-94c9-6a8d12745c44"
	vasptest2ID := "4ff75b3e-a312-490d-a4c2-f17ab7bb9119"

	if vasptest1, err = db.RetrieveVASP(vasptest1ID); err != nil {
		return fmt.Errorf("could not retrieve vasptest1 record: %v", err)
	}

	if vasptest2, err = db.RetrieveVASP(vasptest2ID); err != nil {
		return fmt.Errorf("could not retrieve vasptest2 record: %v", err)
	}

	// Update the legal person record for each VASP
	vasptest1.Entity.Name.NameIdentifiers[0].LegalPersonName = "COOLBITX LTD. TAIWAN BRANCH (CAYMAN) - TEST (GATETW05)"
	vasptest2.Entity.Name.NameIdentifiers[0].LegalPersonName = "COOLBITX LTD. TAIWAN BRANCH (CAYMAN) - DEV-HUB"

	// Update common name and endpoint for each VASP
	vasptest1.CommonName = "gatetw05.test-travelrule.sygna.io"
	vasptest1.TrisaEndpoint = vasptest1.CommonName + ":443"

	vasptest2.CommonName = "hub-trisa.brahma-dev-jp.sygna.io"
	vasptest2.TrisaEndpoint = vasptest2.CommonName + ":443"

	// Load the identity certificates from protobufs
	vasptest1.IdentityCertificate = new(pb.Certificate)
	vasptest2.IdentityCertificate = new(pb.Certificate)

	var data1 []byte
	if data1, err = base64.StdEncoding.DecodeString(vasptest1cert); err != nil {
		return err
	}

	if err = proto.Unmarshal(data1, vasptest1.IdentityCertificate); err != nil {
		return err
	}

	var data2 []byte
	if data2, err = base64.StdEncoding.DecodeString(vasptest2cert); err != nil {
		return err
	}

	if err = proto.Unmarshal(data2, vasptest2.IdentityCertificate); err != nil {
		return err
	}

	// Cannot validate
	// if err = vasptest1.Validate(false); err != nil {
	// 	return fmt.Errorf("vasptest1 is not valid: %v", err)
	// }
	// if err = vasptest2.Validate(false); err != nil {
	// 	return fmt.Errorf("vasptest2 is not valid: %v", err)
	// }

	if err = models.UpdateVerificationStatus(vasptest1, pb.VerificationState_VERIFIED, "manually reissued testnet certificates", "benjamin@rotational.io"); err != nil {
		return fmt.Errorf("could not update VASP record: %v", err)
	}

	if err = models.UpdateVerificationStatus(vasptest2, pb.VerificationState_VERIFIED, "manually reissued testnet certificates", "benjamin@rotational.io"); err != nil {
		return fmt.Errorf("could not update VASP record: %v", err)
	}

	// Create new certificate requests for the reissuance
	password1 := secrets.CreateToken(16)
	password2 := secrets.CreateToken(16)

	fmt.Printf("password for %s (%s): %q\n", vasptest1.CommonName, vasptest1.Id, password1)
	fmt.Printf("password for %s (%s): %q\n", vasptest2.CommonName, vasptest2.Id, password2)

	var certreq1 *models.CertificateRequest
	if certreq1, err = models.NewCertificateRequest(vasptest1); err != nil {
		return err
	}

	var certreq2 *models.CertificateRequest
	if certreq2, err = models.NewCertificateRequest(vasptest2); err != nil {
		return err
	}

	certreq1.Id = "b6b432d9-0ecf-49c5-a5bd-7c59cc422811"
	certreq1.Params["commonName"] = vasptest1.CommonName
	certreq1.Params["dNSName"] = "gatetw05.test-travelrule.sygna.io;gabojpty.test-travelrule.sygna.io;testtwte.test-travelrule.sygna.io;bitbkrse.test-travelrule.sygna.io;doratwtp.test-travelrule.sygna.io;jmchtw02.test-travelrule.sygna.io;gabotwtp.test-travelrule.sygna.io;gaboaumu.test-travelrule.sygna.io;vasptw99.test-travelrule.sygna.io;gatetw06.test-travelrule.sygna.io;sygnafqn.test-travelrule.sygna.io;testtttt.test-travelrule.sygna.io;sygntw81.test-travelrule.sygna.io;gabocato.test-travelrule.sygna.io;sygnafxm.test-travelrule.sygna.io;sygnaf7s.test-travelrule.sygna.io;sygngbln.test-travelrule.sygna.io;sygnafol.test-travelrule.sygna.io;gatetw11.test-travelrule.sygna.io;sygnafn8.test-travelrule.sygna.io"
	certreq1.AuthorityId = 23
	certreq1.BatchId = 314706
	certreq1.BatchName = "trisatest.net-certreq-b6b432d9-0ecf-49c5-a5bd-7c59cc422811"
	certreq1.BatchStatus = "READY_FOR_DOWNLOAD"
	certreq1.OrderNumber = 314706
	certreq1.CreationDate = "2022-03-29 21:47:00"
	certreq1.Profile = "CipherTrace EE"

	certreq2.Id = "1bc4eb32-6a63-4865-865a-98cefb465891"
	certreq2.Params["commonName"] = vasptest2.CommonName
	certreq2.Params["dNSName"] = ""
	certreq2.AuthorityId = 23
	certreq2.BatchId = 314708
	certreq2.BatchName = "trisatest.net-certreq-1bc4eb32-6a63-4865-865a-98cefb465891"
	certreq2.BatchStatus = "READY_FOR_DOWNLOAD"
	certreq2.OrderNumber = 314708
	certreq2.CreationDate = "2022-03-29 21:48:42"
	certreq2.Profile = "CipherTrace EE"

	if err = models.UpdateCertificateRequestStatus(certreq1, models.CertificateRequestState_COMPLETED, "manual certificate request entry", "benjamin@rotational.io"); err != nil {
		return fmt.Errorf("could not update certreq: %v", err)
	}

	if err = models.UpdateCertificateRequestStatus(certreq2, models.CertificateRequestState_COMPLETED, "manual certificate request entry", "benjamin@rotational.io"); err != nil {
		return fmt.Errorf("could not update certreq: %v", err)
	}

	// Connect to secret manager
	var sm *secrets.SecretManager
	if sm, err = secrets.New(conf.Secrets); err != nil {
		return err
	}

	// Make a new secret of type password
	secretType := "password"
	if err = sm.With(certreq1.Id).CreateSecret(context.TODO(), secretType); err != nil {
		return err
	}
	if err = sm.With(certreq1.Id).AddSecretVersion(context.TODO(), secretType, []byte(password1)); err != nil {
		return err
	}
	if err = sm.With(certreq2.Id).CreateSecret(context.TODO(), secretType); err != nil {
		return err
	}
	if err = sm.With(certreq2.Id).AddSecretVersion(context.TODO(), secretType, []byte(password2)); err != nil {
		return err
	}

	// Update the certreq
	if err = db.UpdateCertReq(certreq1); err != nil {
		return err
	}
	if err = db.UpdateCertReq(certreq2); err != nil {
		return err
	}

	// Append the certificate request to the VASP
	if err = models.AppendCertReqID(vasptest1, certreq1.Id); err != nil {
		return err
	}
	if err = models.AppendCertReqID(vasptest2, certreq2.Id); err != nil {
		return err
	}

	// Update the vasps
	if err = db.UpdateVASP(vasptest1); err != nil {
		return err
	}
	fmt.Println(vasptest1.CommonName + " updated")

	if err = db.UpdateVASP(vasptest2); err != nil {
		return err
	}
	fmt.Println(vasptest2.CommonName + " updated")

	return nil
}

func makeIdentityCertificate(path, pkcs12password string) (err error) {
	var archive *trust.Serializer
	if archive, err = trust.NewSerializer(true, pkcs12password, trust.CompressionZIP); err != nil {
		return err
	}

	var provider *trust.Provider
	if provider, err = archive.ReadFile(path); err != nil {
		return err
	}

	var cert *x509.Certificate
	if cert, err = provider.GetLeafCertificate(); err != nil {
		return err
	}

	pub := &pb.Certificate{
		Version:            int64(cert.Version),
		SerialNumber:       cert.SerialNumber.Bytes(),
		Signature:          cert.Signature,
		SignatureAlgorithm: cert.SignatureAlgorithm.String(),
		PublicKeyAlgorithm: cert.PublicKeyAlgorithm.String(),
		Subject: &pb.Name{
			CommonName:         cert.Subject.CommonName,
			SerialNumber:       cert.Subject.SerialNumber,
			Organization:       cert.Subject.Organization,
			OrganizationalUnit: cert.Subject.OrganizationalUnit,
			StreetAddress:      cert.Subject.StreetAddress,
			Locality:           cert.Subject.Locality,
			Province:           cert.Subject.Province,
			PostalCode:         cert.Subject.PostalCode,
			Country:            cert.Subject.Country,
		},
		Issuer: &pb.Name{
			CommonName:         cert.Issuer.CommonName,
			SerialNumber:       cert.Issuer.SerialNumber,
			Organization:       cert.Issuer.Organization,
			OrganizationalUnit: cert.Issuer.OrganizationalUnit,
			StreetAddress:      cert.Issuer.StreetAddress,
			Locality:           cert.Issuer.Locality,
			Province:           cert.Issuer.Province,
			PostalCode:         cert.Issuer.PostalCode,
			Country:            cert.Issuer.Country,
		},
		NotBefore: cert.NotBefore.Format(time.RFC3339),
		NotAfter:  cert.NotAfter.Format(time.RFC3339),
		Revoked:   false,
	}

	// Write the public certificate into the directory service data store
	buf := bytes.NewBuffer(nil)
	if err = pem.Encode(buf, &pem.Block{Type: "CERTIFICATE", Bytes: cert.Raw}); err != nil {
		return fmt.Errorf("could not PEM encode certificate: %s", err)
	}
	pub.Data = buf.Bytes()

	// Write the entire provider chain into the directory service data store
	if archive, err = trust.NewSerializer(false, "", trust.CompressionGZIP); err != nil {
		return err
	}

	// Ensure only the public keys are written to the directory service
	if pub.Chain, err = archive.Compress(provider.Public()); err != nil {
		return err
	}

	// Now serialize and base64 encode the certificate
	var data []byte
	if data, err = proto.Marshal(pub); err != nil {
		return err
	}

	fmt.Println(base64.StdEncoding.EncodeToString(data))
	return nil
}
